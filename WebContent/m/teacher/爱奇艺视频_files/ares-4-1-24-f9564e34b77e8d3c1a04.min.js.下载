/*! @cupid/ares@4.1.24 by iQiyi, Tue Jan 09 2018 11:10:17 GMT+0800 (CST) */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.ares=t():e.ares=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}(function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))switch(typeof e[t]){case"function":break;case"object":e[t]=function(t){var n=t.slice(1),r=e[t[0]];return function(e,t,i){r.apply(this,[e,t,i].concat(n))}}(e[t]);break;default:e[t]=e[e[t]]}return e}([function(e,t,n){e.exports=n(6)},,,,,,function(e,t,n){(function(t,r){function i(){h.ctx=m,h.open(),h.overwriteQueue(l),a()}function o(e,n){if(p.call(this),this.sdk=m,f.element(e)){var r=e;n=t.extend({videoElement:r,entrance:this},n)}else{var i=t.get(window,"Q.PageInfo.i18n")||t.get(window,"uniqy.PageInfo.i18n");n=t.extend({},n,{adPlayerId:e,locale:i})}m.init(n)}function a(){"function"==typeof r.define&&(s()||r.define("ares",function(){return o})),o.AdPadding=o,window.CupidAdSdk=o}function s(){return null!=document.getElementById("flashbox")}var c=n(18)("index"),u=n(24),d=n(146),l="aresqueue",p=n(43),f=t.is,v=n(58),h=n(177)(t.get(r,[l,"q"])),m=new u({},d);r.ares3=e.exports=m,r.aresprint=function(){c(d)},i(),t.inherits(o,p),t.extend(o.prototype,{start:t.noop,stop:function(){var e=this.sdk;e&&e.stop()},notifyCupidSdk:function(e,t){var n=this.sdk;t.sdk=n,n&&n.notifyCupidSdk(e,t)},addEventListener:o.prototype.on,removeEventListener:o.prototype.off,dispatchEvent:o.prototype.emit}),t.extend(o,v.event)}).call(t,n(7),function(){return this}())},[190,8],function(e,t,n){(function(t){function t(e){return this instanceof t?(this.__value=e,void(this.__chain=!1)):new t(e)}var r=n(9);e.exports=r.extend(t,r),n(11),n(12),n(13),n(15),n(16),n(17),t.mixin(t,t)}).call(t,n(7))},[191,10],function(e,t){(function(e){function n(e){var t=a.toString.call(e);return t.substring(8,t.length-1).toLowerCase()}function r(e){return typeof e}function i(e,t){return a.hasOwnProperty.call(e,t)}var o=t,a=Object.prototype,s=e.navigator;o.browser=function(){return!(o.wechatApp()||!s||e.window!=e)},o.h5=function(){return!(!o.browser()||!s.geolocation)},o.mobile=function(){return!(!o.browser()||!/mobile/i.test(s.userAgent))},o.wechatApp=function(){return!("object"!=typeof wx||!wx||!o.fn(wx.createVideoContext))},o._class=n,o._type=r,o.owns=i,o.nan=function(e){return e!==e},o.bool=function(e){return"boolean"==n(e)},o.infinite=function(e){return e==1/0||e==-(1/0)},o.number=function(e){return!isNaN(e)&&"number"==n(e)},o.iod=function(e){return!(!o.number(e)||o.infinite(e))},o.decimal=function(e){return!!o.iod(e)&&0!=e%1},o.integer=function(e){return!!o.iod(e)&&0==e%1},o.oof=function(e){if(e){var t=r(e);return"object"==t||"function"==t}return!1},o.object=function(e){return o.oof(e)&&"function"!=n(e)},o.hash=o.plainObject=function(e){return!(!e||"object"!=n(e))&&(!e.nodeType&&!e.setInterval)},o.undef=function(e){return"undefined"==r(e)},o.fn=function(e){return"function"==n(e)},o.string=function(e){return"string"==n(e)},o.nos=function(e){return o.iod(e)||o.string(e)},o.array=function(e){return"array"==n(e)},o.arraylike=function(e){if(!o.window(e)&&o.object(e)){var t=e.length;if(o.integer(t)&&t>=0)return!0}return!1},o.window=function(e){return!(!e||e.window!=e)},o.empty=function(e){if(o.string(e)||o.arraylike(e))return 0===e.length;if(o.hash(e))for(var t in e)if(i(e,t))return!1;return!0},o.element=function(e){return!(!e||1!==e.nodeType)},o.regexp=function(e){return"regexp"==n(e)}}).call(t,function(){return this}())},function(e,t,n){function r(e,t){var n=[],r=i.len(t);if(r)for(t=t.sort(function(e,t){return e-t});r--;){var o=t[r];n.push(c.splice.call(e,o,1)[0])}return n.reverse(),n}var i=e.exports=n(8),o=i.each,a=i.includes,s=i.is,c=Array.prototype;i.reject=function(e,t){return i.filter(e,function(e,n,r){return!t(e,n,r)})},i.without=function(e){var t=i.slice(arguments,1);return i.difference(e,t)},i.difference=function(e,t){var n=[];return i.each(e,function(e){a(t,e)||n.push(e)}),n},i.pluck=function(e,t){return i.map(e,function(e){if(e)return e[t]})},i.size=function(e){var t=i.len(e);return null==t&&(t=i.keys(e).length),t},i.first=function(e){if(e)return e[0]},i.last=function(e){var t=i.len(e);if(t)return e[t-1]},i.asyncMap=function(e,t,n){var r,i,a=[],s=0;o(e,function(o,c){i=!0,t(o,function(t,i){if(!r){if(s++,t)return r=!0,n(t);a[c]=i,s==e.length&&(r=!0,n(null,a))}})}),i||n(null)},i.uniq=function(e){return i.uniqBy(e)},i.uniqBy=function(e,t){var n=[],r=[];return s.fn(t)||(t=null),o(e,function(e){var i=e;t&&(i=t(e)),a(r,i)||(r.push(i),n.push(e))}),n},i.flatten=function(e){var t=[];return o(e,function(e){s.arraylike(e)?o(e,function(e){t.push(e)}):t.push(e)}),t},i.union=function(){return i.uniq(i.flatten(arguments))},i.sample=function(e,t){for(var n=i.toArray(e),r=n.length,o=Math.min(t||1,r),a=0;a<r;a++){var s=i.random(a,r-1),c=n[s];n[s]=n[a],n[a]=c}return n.length=o,null==t?n[0]:n},i.shuffle=function(e){return i.sample(e,1/0)},i.compact=function(e){return i.filter(e,i.identity)},i.rest=function(e){return i.slice(e,1)},i.invoke=function(){var e=arguments,t=e[0],n=e[1],r=s.fn(n);return e=i.slice(e,2),i.map(t,function(t){if(r)return n.apply(t,e);if(null!=t){var i=t[n];if(s.fn(i))return i.apply(t,e)}})},i.partition=function(e,t){var n=i.groupBy(e,function(e,n,r){var i=t(e,n,r);return i?1:2});return[n[1]||[],n[2]||[]]},i.groupBy=function(e,t){var n={};return i.each(e,function(e,r,i){var o=t(e,r,i);n[o]=n[o]||[],n[o].push(e)}),n},i.range=function(){var e=arguments;if(e.length<2)return i.range(e[1],e[0]);var t=e[0]||0,n=e[1]||0,r=e[2];s.number(r)||(r=1);var o=n-t;0!=r&&(o/=r);for(var a=[],c=t,u=0;u<o;u++)a.push(c),c+=r;return a},i.pullAt=function(e){var t=i.slice(arguments,1);return r(e,t)},i.remove=function(e,t){for(var n=i.len(e)||0,o=[];n--;)t(e[n],n,e)&&o.push(n);return r(e,o)},i.fill=function(e,t,n){}},[192,8],[193,8,14],[194,8],[195,8],[196,8],[197,8],function(e,t,n){function r(e){return i.getLogger(e).getLevelFunction()}var i=n(19),o=i.Log,a=n(23);e.exports=r,o.outputers=[o.custom.outputers.color],o.prefix="ad:ares3:",a.wechatApp()?o.setName("*"):o.init("aresde")},function(e,t,n){var r=n(20),i=r.getLogger();e.exports=t=i},function(e,t,n){(function(r){function i(e){var t=this;l.string(e)&&(e={name:e}),e=e||{},t.name=e.name||i.defaultName,t.enabled=t.isNameMatch(t.name),t.Log=i}function o(e){var t=m.toname(e.level);p.console(t,e.data)}function a(e){e.time=d.now(),s(e)}function s(e){h.push(e),h.length>i.MAX_LOG_LEN&&h.shift()}function c(e){e=e||i.defaultName;var t=v[e];return t||(t=v[e]=new i(e)),t}function u(e){var t=[],n=[];return e&&l.string(e)&&d.each(e.split(/[\s,]+/),function(e){e=e.replace(/\*/g,".*?");var r=e.charAt(0);"-"==r?t.push(new RegExp("^"+d.slice(e,1)+"$")):n.push(new RegExp("^"+e+"$"))}),{skips:t,names:n}}var d=n(7),l=d.is,p=n(21);e.exports=t=i;var f={level:0,MAX_LOG_LEN:3e3,debugKey:"debug",defaultLevelName:"log",defaultName:"default",_name:"",prefix:"",outputers:[],logFilters:[a],custom:{outputers:{color:n(22)}}};d.extend(i,f);var v={},h=i.logs=[];p.hasConsole()&&i.outputers.push(o);var m={name2code:{verbose:0,log:1,debug:2,info:3,warn:4,error:5},toname:function(e){return l.number(e)&&(e=m.code2name[e]),l.string(e)||(e=i.defaultLevelName),e},tocode:function(e){return l.string(e)&&(e=m.name2code[d.lower(e)]),l.number(e)||(e=m.name2code[i.defaultLevelName]),e}};m.code2name=d.invert(m.name2code),i.LEVEL=m,i.setLevel=function(e){i.level=m.tocode(e)},i.setName=function(e){i._name=e,i.pattern=u(e),d.forIn(v,function(t){t.enabled=t.isNameMatch(e)})},i.getPlainLog=function(){return d.map(i.logs,function(e){return d.map(e.data,function(e){var t=e;if(r.JSON)try{t=JSON.stringify(e)}catch(n){t="[Nested]"}return t}).join(" ")}).join("\r\n")},i.getLogger=c,i.setName(i._name),i.setLevel(i.level),i.init=function(e){e=e||i.debugKey;var t;if(r.location){var n=new RegExp(e+"=(\\S+)"),o=n.exec(r.location.href);o&&(t=o[1])}if(null==t)try{t=localStorage[e]}catch(a){}null==t&&r.process&&(t=d.get(r,["process","env",e])),i.setName(t)},i.init();var g=i.prototype;g.getLogger=c,g.getLevelFunction=function(e){var t=m.tocode(e),n=this;return function(){n.print(t,arguments)}},d.each(d.keys(m.name2code),function(e){var t=m.tocode(e);i[d.upper(e)]=t,g[e]=function(){var e=this;e.print(t,arguments)}}),g.print=function(e,t){var n=this;if(n.enabled&&e>=i.level){var r={level:e,name:n.name,data:t};d.each(i.logFilters,function(e){e(r,i.lastLog)}),i.lastLog=r,d.each(i.outputers,function(e){e(r,i)})}},g.isNameMatch=function(e){function t(t){return t.test(e)}var n=i.pattern;return!!e&&(!d.some(n.skips,t)&&!!d.some(n.names,t))}}).call(t,function(){return this}())},function(e,t){(function(e){t.hasConsole=function(){return!!e.console},t.console=function(e,t){var n=Function.prototype.apply||console[e].apply;n.call(console[e],console,t)}}).call(t,function(){return this}())},function(e,t,n){function r(){return!!u.wechatApp()||!i()&&!!u.browser()}function i(){return!(!u.browser()||!/Trident/i.test(navigator.userAgent))}function o(e,t){var n=c.now(),r=n-(s||n),i="color:"+a(e.name);s=n;var o=t.prefix+e.name,u="%c"+o+"%c",l=[null,i,f];c.each(e.data,function(e){l.push(e),u+=" %o"}),l.push(i),u+="%c +"+r+"ms",l[0]=u,d.console("log",l)}function a(e){return v[e]||(v[e]=l[p++%l.length]),v[e]}var s,c=n(7),u=c.is,d=n(21),l="lightseagreen forestgreen goldenrod dodgerblue darkorchid crimson".split(" "),p=0,f="color:inherit",v={};e.exports=c.noop,d.hasConsole()&&(r()?e.exports=o:e.exports=function(e,t){d.console("log",e.data)})},10,function(e,t,n){(function(t,r){function i(e,n){var r=this;r.adTheme="default",r.relatedTheme="default",r.setParent(n),p.call(r,u),t.extend(r,P),r.bindNormalEvent(),r.bindToolFunc(),r.version=r.getVal("sdkVersion"),r.adMap={},r.external=k}function o(e,t){function n(){var n=e.width(),r=n==a;r||(d("video resize",a,"==>",n),t(),a=n)}$(window).off("resize");var r=5e3,i=100,o=new b(i,r/i),a=e.width();o.on("timer",n),$(window).on("resize",function(){n(),o.reset(),o.start()})}function a(e){var n=e||{};return n.episodeId=n.episodeId||n.tvId,n.adPlayerId=n.adPlayerId||n.playerId,n.videoDuration=n.videoDuration||n.duration,n.isVIP=n.isVIP||n.isVip,n.videoDefinition=n.videoDefinition||n.resIndex,n=t.extend({isVIP:!1},n)}function s(e){return v.isAdPlayerId(e)||(d("invalid cid, use default cid"),e=E),e}function c(e,n){var r="mp4";return e?"m3u8"==t.lower(e)&&(r="m3u8"):"i"==t.lower(t.first(n))&&(r="m3u8"),r}var u="sdk",d=n(18)(u),l=n(19),p=n(42),f=n(59),v=n(74),h=n(173),m=n(94),g=n(115),y=n(112),b=n(96),x=n(61),w=n(79),T=n(131),I=n(130),k=n(176),P=n(169),C=t.is,A="uaaUserId adPlayerId passportId videoMidware videoElement passportCookie isVIP clientVersion isMacH5 showVoiceIcon locale formatType deviceType vId entrance adTheme relatedTheme".split(" ");e.exports=i;var V="qc_105136_100610",E="qc_100001_100226";t.inherits(i,p);var _=i.prototype;_.getSummary=function(){var e=this;return"sdk: "+e.version},_.showSummary=function(){var e=this;e.$panel=e.$panel||$("<div>").css({position:"fixed",top:100,right:100,"min-width":"100px","min-height":"100px",background:"#fff"}).addClass("cupid-summary-panel");var t=v.getSummaryTreeInDom(e);return e.$panel.empty().append(t),e.$panel.show().appendTo("body"),e.$panel[0]},_.init=function(e){var n=this;d("entrance init",e,e.episodeId),e=t.extend({},e),e=a(e);var r=t.only(e,A);if(t.extend(n,r),n.locale){var i=n.locale;i=t.includes(["tw_t","cn_t","zh-TW"],i)?"tw":"cn";var o=m.setLocale(i);d("set locale",n.locale,"get",o)}t.includes(n.locale,"tw")&&(n.adPlayerId=V,d("force use tw cid",V)),n.isH5VideoMode()&&(n.formatType=c(n.formatType,n.deviceType),d("use format type",n.formatType)),n.adPlayerId=s(n.adPlayerId),n.uaaUserId=n.uaaUserId||v.getUaaUserId(),n.video||(n.video=new h(n.videoElement,n));var u=new f(e,n);return d("currentView",n.currentView,n),n.currentView&&n.video&&!u.isPreload&&n.onManualSwitchView(),n},_.stop=function(e){var n=t.get(e,"videoEventId");d("stop view",n);var r=this;if(t.remove(r.children,function(e){return e.videoEventId==n&&(e.isCurrentView()&&(r.currentView=null),e.abort(),r.video&&r.video.enableVideo(),!0)}),r.isH5VideoMode()){var i=r.video;i&&(i.hideAllAdElements("sdk结束"),i.$video.off())}},_.notifyCupidSdk=function(e,t){d("notify cupid sdk:",e,t);var n=this,r=n[e];C.fn(r)&&r(t)},_.removeInvalidAd=function(e){var n=e.vid,r=e.sdk||this,i=r.children[r.children.length-1];d("currentview",r.currentView),C.array(n)&&n.length>0?t.each(n,function(e){d("find invalid ad and remove it",e),v.getAdByVidAndRemove(e,i)}):d("no invalid vid",e)},_.onManualSwitchView=function(){var e=this,t=e.currentView;t&&(d("手动切集"),e.currentView=null,t.abort())},_.switchToVideoViewById=function(e){var n=this,r=t.find(n.children,function(t){return!t.isExpired&&t.videoEventId==e});r&&n.switchToVideoView(r)},_.switchToVideoView=function(e){if(e&&e.isVideoView()){var n=this;if(n.currentView!=e){n.currentView&&(n.lastView=n.currentView,n.lastView.isExpired=!0),n.currentView=e,d("switch to video view",e.episodeId);var r=t.filter(n.children,function(e){return!(!e.isVideoView()||e==n.currentView)});t.each(r,function(e){e.abort()}),n.children=t.difference(n.children,r),e.tryPlayPreload()}}},_.smartGetAd=function(e){var t=this;return v.smartGetAd(t,e)},_.bindNormalEvent=function(){var e=this;e.on("bridge",function(t,n,r){d("bridge",t,n,r);var i=v.getAdById(t,e);i&&i.emit("bridge",n,r)}),e.on("click",function(t){if(d("click",t),t){var n=v.getAdById(t.id,e);n&&n.emit("clickAndOpen")}}),e.on("impression",function(t){if(d("impression",t),t){var n=v.getAdById(t.id,e);n&&n.emit("impression")}}),e.on("impressionAdZone",function(n){d("impressionAdZone",n);var r=t.get(n,"adZoneId"),i=e.currentView;i&&r&&t.each(i.children,function(e){t.each(e.children,function(e){e.adZoneId==r&&e.sendEmptyTrackingBeforeTimeSlice(1/0)})})}),e.on(e.DEFINITION_SWITCHING_SHOW,function(){e.emit("impressionAdZone",{adZoneId:e.DEFINITION_SWITCHING_SHOW})})},_.bindVideoEvent=function(){d("bind video event");var e=this;if(e.getVal("isVideoSupportOverlay")){var n=e.video;n&&(n.on("pause",function(t){var r=v.getActionType(t);if("controls"==r){var i=n.currentTime();if(i){var o=e.currentView;o&&null==n.getCurrentAd()&&(d("user pause",i),o.pauseTimes++,o.loadPause(),o.pause())}}}),n.on("play",function(){d("play");var r=e.currentView;r&&(r.tryStopPauseAd(),t.delay(function(){null==n.getCurrentAd()&&r.showAndResume()}))}),e.bindMouseMove())}return o(e.video.$video,function(){e.resize()}),e},_.resize=function(){var e=this;e.currentView&&e.currentView.resize()},_.isH5VideoMode=function(){return!!this.videoElement},_.isPCWVideoMode=function(){return!!this.videoMidware},_.bindMouseMove=function(){var e=this,t=new b(1e3,5),n=0;t.on("timer",function(){var e=t.repeatCount-t.currentCount;d("mousemove countdown",e+"/"+t.repeatCount)}),t.on("timerComplete",function(){var t=e.currentView;t&&t.tryStopToolbar()}),e.video.$video.on("mousemove",function(){if(n++,1==n&&setTimeout(function(){n=0},1e3),n>=10){var r=e.currentView;r&&r.isVideoPlaying&&(r.tryPlayToolbar(),n=0,t.start())}t.currentCount=0})},_.unbindMouseMove=function(){var e=this;e.video.$video.off("mousemove")},_.bridgeEmit=function(e,t,n){return this.emit("bridge",e,t,n)},_.getUser=function(){var e=this,n=t.only(e,"isVIP passportId passportCookie uaaUserId cupidUserId");if(e.isPCWVideoMode()){var r=e.video.getUserInfo();t.extend(n,r)}return n||{}},_.updateUser=function(){var e=this,n=e.getUser();return d("update user info",n),t.extend(e,n),n},_.bindToolFunc=function(){t.extend(this,{md5:y,base64:g,i18n:m,$:window.$,_:t,qs:x,url:w,byteCode:T,Promise:r,tool:v,log:l},I)}}).call(t,n(7),n(25))},function(e,t,n){var r=(n(26),n(38));r.resolve=n(40),r.reject=n(41),r.prototype["catch"]=r.prototype.caught=function(e){return this.then(null,e)},e.exports=r},[190,27],[198,26,28,30,31,32,33,34,36,37],[191,29],10,[199,27],[195,27],[200,27],[192,27],[193,27,35],[194,27],[196,27],[197,27],function(e,t,n){(function(t,r,i){function t(e){var t=this;t.handlers={},t.children=[],t.state=d;var n=f(t,l),r=f(t,p);try{e(function(e){n(e)},function(e){r(e)})}catch(i){r(i)}}function o(e,t,n){e.state=t,e.result=n,c.each(e.children,function(e){a(e,t,n)})}function a(e,t,n){s(function(){var r=e.handlers[t];if(u.fn(r)){var i;try{i=r(n)}catch(a){return o(e,p,a)}f(e,l,i)}else f(e,t,n)})}function s(e){r.process&&i.nextTick?i.nextTick(e):setTimeout(e)}var c=n(26),u=c.is,d=0,l=1,p=-1;e.exports=t,t.prototype.then=function(e,n){var r=this,i=new t(c.noop),o=i.handlers;return o[l]=e,o[p]=n,d==r.state?r.children.push(i):a(i,r.state,r.result),i};var f=c.curry(function(e,t,n){if(e===n)return f(e,p,new TypeError("circle promise"));if(e.state==d){var r;if(u.oof(n))try{r=n.then}catch(i){return o(e,p,i)}if(u.fn(r)){var a=c.once(function(t,n){t==p?o(e,t,n):f(e,t,n)});try{r.call(n,function(e){a(l,e)},function(e){a(p,e)})}catch(s){a(p,s)}}else o(e,t,n)}})}).call(t,n(25),function(){return this}(),n(39))},function(e,t){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(e){if(d===setTimeout)return setTimeout(e,0);if((d===n||!d)&&setTimeout)return d=setTimeout,setTimeout(e,0);try{return d(e,0)}catch(t){try{return d.call(null,e,0)}catch(t){return d.call(this,e,0)}}}function o(e){if(l===clearTimeout)return clearTimeout(e);if((l===r||!l)&&clearTimeout)return l=clearTimeout,clearTimeout(e);try{return l(e)}catch(t){try{return l.call(null,e)}catch(t){return l.call(this,e)}}}function a(){h&&f&&(h=!1,f.length?v=f.concat(v):m=-1,v.length&&s())}function s(){if(!h){var e=i(a);h=!0;for(var t=v.length;t;){for(f=v,v=[];++m<t;)f&&f[m].run();m=-1,t=v.length}f=null,h=!1,o(e)}}function c(e,t){this.fun=e,this.array=t}function u(){}var d,l,p=e.exports={};!function(){try{d="function"==typeof setTimeout?setTimeout:n}catch(e){d=n}try{l="function"==typeof clearTimeout?clearTimeout:r}catch(e){l=r}}();var f,v=[],h=!1,m=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];v.push(new c(e,t)),1!==v.length||h||i(s)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=u,p.addListener=u,p.once=u,p.off=u,p.removeListener=u,p.removeAllListeners=u,p.emit=u,p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(e,t,n){var r=n(38);e.exports=function(e){return new r(function(t,n){t(e)})}},function(e,t,n){var r=n(38);e.exports=function(e){return new r(function(t,n){n(e)})}},function(e,t,n){(function(r,i){function o(e){var t=this;t[l]=e,t.memory={},s.call(t),t.setState("idle")}function a(e){var t=-1;return e&&e.getCuepointType&&(t=e.getCuepointType()),t=parseInt(t),c.number(t)||(t=-1),t}var s=n(43),c=r.is,u=n(58);e.exports=t=o;var d="global sdk view request slot ad env".split(" "),l="contextName";r.inherits(o,s);var p=o.prototype;o.getLevel=function(e){return r.indexOf(d,e)},p.isContext=function(e){return this[l]==e},p.index=function(){var e=this;return e.parent?r.indexOf(e.parent.children,e):-1},p.setState=function(e){var t=this;t.state!=e&&(t.lastState=t.state,t.state=e,t.emit("statechange",e))},p.belong=function(e){var t=r.indexOf(d,this[l]),n=r.indexOf(d,e);return t>-1&&n>-1&&n<=t},p.setParent=function(e){var t=this;e&&(t[e[l]]=t.parent=e,e.children=e.children||[],e.children.push(t))},p.getParentByName=function(e){for(var t=this;t;){if(t[l]==e)return t;t=t.parent}},p.getVideo=function(){var e=this,t=e.getParentByName("sdk");if(t)return t.video},p.getVal=function(e){for(var t=this;t;){if(r.has(t,e))return t[e];t=t.parent}},p.getMultiVals=function(e){var t=this,n={};return r.each(e,function(e){n[e]=t.getVal(e)}),n},p.getInfo=function(){return{}},p.getParam=function(){for(var e=this,t=8,n=[];t--&&e;)n.push(e),e=e.parent;return n.reverse(),n.unshift({}),r.extend.apply(r,n)},p.isPause=function(){return u.pause==a(this)},p.isPreroll=function(){return u.preroll==a(this)},p.isMidroll=function(){return u.midroll==a(this)},p.isRoll=function(){return r.includes([u.preroll,u.midroll,u.postroll],a(this))},p.isPage=function(){return u.page==a(this)},p.isToolbar=function(){return u.toolbar==a(this)},p.isViewPoint=function(){return u.viewPoint==a(this)},p.isGeneralOverlay=function(){var e=[u.viewPoint,u.common_overlay,u.common_overlay2];return r.includes(e,a(this))},p.isEnded=function(){var e=this.state,t="ended"==e||"end"==e;return!!t},p.runIfNotEnded=function(e){this.isEnded()||e()},p.isLiving=function(e){var t,n=this;if(n.error?t=n.error:n.isEnded()&&(t="ended"),t)return i.reject(t);var r=e();return i.resolve(r)},r.each("pause resume resize".split(" "),function(e){p[e]=function(){var t=this;t.runIfNotEnded(function(){r.each(t.children,function(t){if(t.isContext("ad")){var n=r.includes(["playing","paused","complete"],t.state);if(!n)return}t[e]()})})}})}).call(t,n(7),n(25))},function(e,t,n){function r(){return this instanceof r?void(this[a]=new o):new r}var i=n(44),o=n(56);e.exports=r;var a="emitter",s=r.prototype;s.on=function(e,t){return this[a].on(e,t)},s.once=function(e,t){return this[a].once(e,t)},s.emit=function(e){var t=i.slice(arguments,1),n=this;return n[a].emit(e,null,function(e){e.handler.apply(n,t)})},s.off=function(e,t){var n;return t&&(n=function(e){return e.handler==t}),this[a].off(e,n)}},[190,45],[198,44,46,48,49,50,51,52,54,55],[191,47],10,[199,45],[195,45],[200,45],[192,45],[193,45,53],[194,45],[196,45],[197,45],function(e,t,n){function r(){return this instanceof r?void(this.cache={}):new r}function i(){return!0}function o(e){e.handler()}var a=n(44),s=n(57),c=a.is;e.exports=r;var u=r.prototype;u.on=function(e,t){if(c.fn(t)){var n={};n.handler=t;var r=s(this.cache,e,[]);return r.push(n),n}},u.once=function(e,t){function n(){r||(r=!0,i.off(function(e){return e.handler==n}),n=null,t.apply(this,arguments))}if(c.fn(t)){var r,i=this;return i.on(e,n)}},u.emit=function(e,t,n){var r=this.filter(e,t);return a.each(r,n||o),r},u.off=function(e,t){void 0===e?this.cache={}:a.remove(this.cache[e],t||i)},u.filter=function(e,t){return a.filter(this.cache[e],t||i)}},function(e,t){e.exports=function(e,t,n){if(n=n||{},e){if(null!=e[t])return e[t];e[t]=n}return n}},function(e,t,n){(function(e){var n=t;n.name2cuepoint={page:0,preroll:1,midroll:2,postroll:3,corner:4,mark:5,pause:6,toolbar:7,viewPoint:8,overlay:9,common_overlay:10,common_overlay2:11},n.event={EVENT_CUPID_READY:"ready",EVENT_CUPID_NO_AD:"noad"},e.extend(n,n.name2cuepoint),n.cuepoint2name=e.invert(n.name2cuepoint)}).call(t,n(7))},function(e,t,n){(function(t,r){function i(e,t){var n=this;c.call(n,a),n.setParent(t),n.sdk=t,n.video=n.sdk.video,n.init(e),n.currentOverlayAds=[],n.bindEvent(),n.toolbarRequest=null,n.isBusyLoading=!0,n.hasPrerollRequestFailed=!1,n.pageUrl=v.getPageUrl()}function o(e){var n=[e.episodeId,e.uaaUserId,t.now(),Math.random()];return d(n.join(""))}var a="view",s=n(19).Log,c=n(42),u=n(60),d=n(112),l=n(113),p=n(171),f=n(58),v=n(74),h=t.is,m="videoEventId channelId episodeId albumId videoDefinition videoDuration autoload playSource isPreload".split(" ");e.exports=i,t.inherits(i,c);var g=i.prototype;g.getSummary=function(){var e=this,t=[];return e.isCurrentView()&&t.push("进行中!!"),e.isVideoView()&&(t.push("视频",e.episodeId),e.isPreload&&t.push("连播")),t.push(e.videoEventId),t.join(" ")},g.isVideoView=function(){var e=this;return!(h.empty(e.episodeId)||!e.video)},g.isCurrentView=function(){var e=this;return!(!e.sdk||e!=e.sdk.currentView)},g.notifyPlayer=function(e){var n=this;e=t.extend({tvId:n.episodeId,videoEventId:n.getVal("videoEventId")},e),n.log.debug("notify video adplayer_ad_info",e),n.sdk.emit("adplayer_ad_info",e)},g.notifyH5Player=function(e,t){var n=this;n.log.debug("notify h5 player",e,t);var r={type:e,data:t},i=n.getVal("entrance");i&&i.dispatchEvent(e,r)},g.tryPlayToolbar=function(){var e=this;if(e.toolbarRequest)e.toolbarRequest.tryReplay();else if(e.schedule){var t=e.schedule.getAdBreaksByType(f.toolbar);h.empty(t)||(e.log.debug("request toolbar"),e.toolbarRequest=new l({adBreaks:t},e),e.toolbarRequest.play())}},g.tryStopToolbar=function(){var e=this;e.toolbarRequest&&(e.log.debug("stop toolbar"),e.toolbarRequest.abort())},g.startVideo=function(e){var t=this;if(!0!==t.isVideoPlaying&&!t.ended){var n="roll-ended",r={rollType:e,videoEventId:t.getVal("videoEventId")};t.log.debug(n,r),t.onNetworkFree(),t.sdk.emit(n,r),t.schedule&&(t.schedule.startTimer(),t.showAndResume()),t.isVideoPlaying=!0,t.sdk.video.removeOptions("video start")}},g.startLoadVideo=function(e){var t=this;if(!t.ended){e=e||{};var n="roll-load-finish",r={rollType:e.rollType,reason:e.reason,videoEventId:t.getVal("videoEventId")};t.log.debug(n,r),t.sdk.emit(n,r)}},g.stopVideo=function(e){var t=this;if(!1!==t.isVideoPlaying){var n="roll-play",r={videoEventId:t.getVal("videoEventId"),rollType:e};t.log.debug(n,r),t.sdk.emit(n,r),t.schedule&&t.schedule.stopTimer(),t.isVideoPlaying=!1}},g.init=function(e){var n=this;e=t.extend({playSource:0,isPreload:!1},e);var i=t.only(e,m);t.extend(n,i),n.log=s.getLogger("view:"+(n.episodeId||"untitled")),n.log.debug("init");var a=e.videoEventId||o(e);n.id=n.videoEventId=a,n.isVideoView()&&(n.adPlayedDurationInView=0,n.midrollPointsPlayedInView=0,n.lastRollCompleteTime=NaN,n.lastMidrollRequestTime=0,n.pauseRequestTimes=0,n.pauseTimes=0),n.schedule=new p(n),u.send(n,{type:"visit",subtype:"success",location:t.get(r,"location.href"),customInfo:n.getVal("sdkUrl")});var c=this;return c.isPreload&&c.sdk.currentView&&(c.continueFromView=c.sdk.currentView),0!=n.autoload&&n.load(e),n},g.getContinuingViews=function(){for(var e=this,t=[],n=e.continueFromView;n;)t.push(n),n=n.continueFromView;return t},g.load=function(e){var t=this;t.log.debug("load"),e=e||{};var n=new l(e,t);return t.isPreload||n.play(),t},g.tryPlayPreload=function(){var e=this;if(e.isPreload){var n=t.first(e.children);n&&n.play()}},g.onNetworkFree=function(){var e=this;if(e.isBusyLoading){e.log.debug("network free"),e.isBusyLoading=!1;var t=e.sdk;t.isPCWVideoMode()&&e.tryRequestSecondaryAd()}},g.tryRequestSecondaryAd=function(){var e=this;if(e.log.debug("try load viewpoint and page"),e.schedule){var t=e.schedule.getAdBreaksByType(f.viewPoint),n=e.schedule.getAdBreaksByType(f.page),r=t.concat(n);if(!h.empty(r)){var i=new l({adBreaks:r},e);i.play()}}},g.abort=function(){var e=this;e.ended||(e.log.debug("abort"),e.ended=!0,e.schedule&&e.schedule.stopTimer(),v.notifyPage("clearAds",{templateType:"viewPoint",adZoneId:e.viewPointAdZoneId,videoEventId:e.getVal("videoEventId")}),t.map(e.children,function(e){e.abort()}))},g.bindEvent=function(){var e=this;return e.once("startLoadVideo",function(t){e.startLoadVideo(t)}),e},g.loadPause=function(e){var n=this;if(n.schedule){var r=n.schedule.getAdBreaksByType(f.pause);if(r=t.map(r,function(e){return t.extend({},e,{sequenceId:n.pauseTimes})}),h.empty(r))n.log.debug("no pause schedule");else{n.log.debug("load pause"),e=e||{},e.requestIndex=e.requestIndex||1,n.pauseRequestTimes++;var i=new l({adBreaks:r,requestIndex:e.requestIndex,from:e.from},n);i.play()}}},g.addCurrentOverlayAd=function(e){this.currentOverlayAds.push(e)},g.removeCurrentOverlayAd=function(e){t.remove(this.currentOverlayAds,function(t){return e==t})},g.showAndResume=function(){var e=this;e.resume(),t.each(e.currentOverlayAds,function(t){e.log.debug("show and resume current overlay",t.format());var n=t.$adzone;n&&n.show()})},g.tryStopPauseAd=function(){var e=this;t.remove(e.children,function(e){if(e.isPause())return e.abort(),!0})}}).call(t,n(7),function(){return this}())},function(e,t,n){(function(r){function i(){var e=this;e.uncompressedParam={},e.compressedParam={}}var o=n(18)("pingback"),a=n(61),s=n(74),c=n(99),u=n(42),d=r.is;e.exports=t=i;var l=["isVIP","isPreload"],p="http://msg.71.am/cp2.gif",f={visit:"v",player:"pl",policy:"p",show:"s",template:"tp",creative:"c",tracking:"t",exchangeTracking:"x",mixer:"m",statistics:"st",ad:"a",inventory:"i",questionnaireInquiry:"qi"},v={success:"s",error:"e",load:"l",skip:"sk",skipClick:"sc",click:"clk",impression:"imp",adblock:"adb",close:"cls",start:"st",unsupported:"uns"},h={type:"p",subtype:"t",uaaUserId:"u",cupidUserId:"a",episodeId:"v",albumId:"b",channelId:"c",videoEventId:"e",adPlayerId:"y",customInfo:"x",timestamp:"s",videoDuration:"d",isVIP:"g",isPreload:"pl",passportId:"pp",location:"lc",sdkVersion:"av",clientVersion:"vv",requestId:"rid",sequenceId:"sq",orderItemId:"od",creativeId:"ct",dspId:"dp",adInfo:"ai",adStrategy:"as",rawInventory:"ri",originalInventory:"oi",deliveredInventory:"di",forbiddenInventory:"fi",requestDuration:"rd",requestCount:"rc",reqCount:"rc",errorCode:"ec",errCode:"ec",errorMessage:"em",errMessage:"em",errMsg:"em"},m=c(h),g="type subtype timestamp videoEventId adPlayerId uaaUserId cupidUserId sdkVersion clientVersion isVIP videoDuration requestId",y={visit:"episodeId albumId channelId location passportId customInfo isPreload",show:"requestCount requestDuration",creative:"",tracking:"",statistics:"",ad:"episodeId albumId channelId sequenceId",inventory:"episodeId albumId channelId rawInventory originalInventory deliveredInventory forbiddenInventory"};i.send=function(e,t,n){var r=new i;r.addUncompressedParam(t),r.addCompressedParam(n),r.getType(),r.getContextParam(e),r.filterContextParam(),r.mergeContextParam(),r.normalizeParam(),r.compressKey(),r.mergePingbackParam(),r.send()},i.sendStatistics=function(e,t,n){return i.send(e,{type:"statistics",subtype:t,customInfo:n})};var b=i.prototype;b.getContextParam=function(e){var t=this;e instanceof u?(t.context=e,t.contextParam=e.getParam()):t.contextParam=e},b.filterContextParam=function(){var e=this,t=g+" "+y[e.type];e.contextParam=r.only(e.contextParam,t)},b.mergeContextParam=function(){this.addUncompressedParam(this.contextParam)},b.getType=function(){var e=this,t=e.uncompressedParam;e.type=e.type||t.type,e.subtype=e.subtype||t.subtype,t.type=f[e.type]||e.type,t.subtype=v[e.subtype]||e.subtype},b.normalizeParam=function(){var e=this,t=e.uncompressedParam;if(e.context&&e.context.isContext("ad")){var n=e.context;e.addUncompressedParam({adInfo:n.getAdInfo()})}r.each(l,function(e){var n=t[e];d.bool(n)&&(t[e]=n?1:0)}),t.timestamp=s.getCalibratedTime(),r.forIn(t,function(e,n){if(d.string(e)){var r=e.length;"em"==n&&r>300&&(e=e.slice(0,150)+"||"+e.slice(r-150)),t[n]=e}})},b.addCompressedParam=function(e){r.extend(this.compressedParam,e)},b.addUncompressedParam=function(e){r.extend(this.uncompressedParam,e)},b.compressKey=function(){var e=this;e.addCompressedParam(m(e.uncompressedParam))},b.mergePingbackParam=function(){var e=this;if(e.context){var t=e.context.getVal("pingbackParam");e.addCompressedParam(t)}},b.send=function(){var e=this,t=e.compressedParam||{};o("send",e.type||t.p,e.subtype||t.t,e.uncompressedParam,t);var n=p+"?"+a.stringify(t);s.ping(n)}}).call(t,n(7))},[201,62],[190,63],[198,62,64,66,67,68,69,70,72,73],[191,65],10,[199,63],[195,63],[200,63],[192,63],[193,63,71],[194,63],[196,63],[197,63],function(e,t,n){(function(e,r,i){function o(e){var t=!0;try{window.__player__.errorTip(e)}catch(n){t=!1,a("show black screen fail",n.message)}return t}var a=n(18)("tool"),s=n(75),c=e.document,u=n(76),d=n(78),l=r.is,p=n(79),f=n(93),v=n(94),h=n(95).template,m=n(96),g=n(61);t.addStyle=r.once(function(){a("add style");var e=c.createElement("style");e.type="text/css";var t=n(97);e.styleSheet?e.styleSheet.cssText=t:e.innerHTML=t,$("head").append(e)}),t.getSummaryTree=function(e){var n={};if(e){n.name=e.getSummary();var i=r.map(e.children,function(e){return t.getSummaryTree(e)});i.length&&(n.children=i)}return n},t.getSummaryTreeInDom=function(e){var n=$("<div>");if(e){var i=$("<span>");i.text(e.getSummary()),n.append(i);var o=$("<ul>");
r.each(e.children,function(e){var n=t.getSummaryTreeInDom(e),r=$("<li>");r.append(n),o.append(r)}),n.append(o)}return n},t.sumBy=function(e,t){var n=0;return r.each(e,function(e){n+=r.get(e,t)||0}),n},t.isWechatApp=function(){return!("object"!=typeof wx||!wx||!l.fn(wx.createVideoContext))},t.isPageSupportViewPoint=function(){return t.isPageSupportAd("viewPoint")},t.parseJSON=function(t){var n=r.get(e,"JSON.parse")||$.parseJSON;return n(t)},t.rawNotifyPage=function(e){try{return Q.__callbacks__.iqiyi_player_notice(e)}catch(t){}},t.notifyPage=function(e,n){a("notify page",e,n);var r,i={type:e,data:n};try{r=JSON.stringify(i)}catch(o){r=null}if(r)return t.rawNotifyPage(r)},t.isPageSupportAd=function(e){try{return Q.external.checkAdSupport(e)}catch(t){return!1}},t.isPageJobDone=function(){try{return Q.external.jobdone()}catch(e){return!1}},t.waitPageJobDone=function(e){if(t.isPageJobDone())e();else var n=m.interval(function(){t.isPageJobDone()&&(n.stop(),e())},1e3)},t.open=function(t,n){if(r.size(t)>2){l.mobile()&&(n="_self");var i=e.open(t,n||"_blank");i&&(i.opener=null)}},t.getCalibratedTime=function(){var e=r.now();return l.integer(t.deltaTime)&&(e+=t.deltaTime),e},t.getTrackingTime=function(){return parseInt(t.getCalibratedTime()/1e3)},t.isRoll=function(e){return e=parseInt(e),r.includes([1,2,3],e)},t.getAdById=function(e,t){return r.get(t,["adMap",e])},t.getAdById2=function(e,n){return t.getAd(n,function(t){return t.id==e})},t.smartGetAd=function(e,n){return t.getAd(e,function(e){return t.isAdMatch(e,n)})},t.isAdMatch=function(e,t){if(e){var n=e.creative,i=e.slot;if(n&&i){var o=[e.id,e.orderItemId,i.adZoneId,n.creativeId,n.templateType];return o=r.map(o,r.lower),r.includes(o,r.lower(t))}}return!1},t.getAd=function(e,t){var n;return r.some(e.children,function(e){return r.some(e.children,function(e){return r.some(e.children,function(e){return r.some(e.children,function(e){return!!t(e)&&(n=e,!0)})})})}),n},t.getAdByVidAndRemove=function(e,t){r.each(t.children,function(t){t.isPreroll()&&r.each(t.children,function(t){if(1==t.cuepointType)for(var n=t.ads.length-1;n>=0;n--){var r=t.ads[n];r.matchedVideo&&e==r.matchedVideo.video&&(a("find ad by invalid vid",e,r.matchedVideo.video),t.duration=t.duration-r.duration,r.emit("error",new d("creative http error",r.creative.creativeObject,u.CREATIVE_HTTP_ERROR)),t.ads.splice(n,1),a("remove ad by invalid vid success",t.ads))}})})},t.isAdPlayerId=function(e){return!!r.startsWith(e,"qc_")&&e.length=="qc_100001_100000".length},t.isAd=function(e){return!!(e&&"orderItemId"in e)},t.getAllParam=function(e){for(var t=8,n=[];t--&&e;)n.push(e),e=e.parent;return n.reverse(),n.unshift({}),r.extend.apply(r,n)};var y=1024,b={1:300,2:600,3:1.1*y,4:1.5*y,5:3*y,10:8*y,96:170},x=r.map([["jUrl","f4v",1,-1e3],["bUrl","f4v",170],["gUrl","f4v",300],["cUrl","f4v",1.5*y],["lowUrl","f4v",300,-1e3],["highUrl","f4v",600,-1e3],["m200Url","mp4",300],["m400Url","mp4",600],["jVid","vid",1,-1e3],["bVid","vid",170],["gVid","vid",300],["cVid","vid",1.5*y],["m200Vid","mvid",300],["m400Vid","mvid",600]],function(e){return{key:e[0],videoFormat:e[1],minBandwidth:e[2],priority:e[3]}});t.chooseAdVideoByVideoDefinition=function(e,t,n){e=e||{};var i=b[t]||1*y,o=r.map(x,function(t){var o=-1,a=t.key,s=e[a];return n==t.videoFormat&&(l.empty(s)||(o=2e3+(t.priority||0),o+=i>=t.minBandwidth?t.minBandwidth:1/t.minBandwidth)),r.extend({score:o,video:s},t)}),a=r.max(o,function(e){return e.score});if(a.score>0){var s="g",c=a.minBandwidth;return c<=170?s="b":c>=1.5*y&&(s="c"),a.videoDefinition=t,a.definitionLevel=s,a}},t.translate=r.curry(function(e,t){return r.mapKeys(t,function(t,n){return e[n]})}),t.convertBoolInQuery=r.curry(function(e,t){return r.each(e,function(e){var n=t[e];l.bool(n)&&(n=n?1:0),t[e]=n})}),t.isEmptySlot=function(e){if(e){if(!l.empty(e.ads))return!1;var t=e.emptyTracking;if(t&&!l.empty(t.timeSlices))return!1}return!0},t.getUaaUserId=function(){var e=s.get("QC005");return l.empty(e)&&(e=s.get("QC006")),e||""},t.getFirstTimeSlice=function(e){var t=NaN;return l.string(e)&&(e=e.split(",")),t=parseInt(r.first(e))},t.getPageUrl=function(){return p.parse(r.get(e,"location.href"),!0)},t.getPathBasename=function(e){return r.last(r.split(e,"/"))},t.getUrlBasename=function(e){if(e=p.parse(e))return t.getPathBasename(e.pathname)},t.ping=function(e){(new Image).src=e},t.replacePlain=function(e,n,i,o){if(e&&n){var a=e.split(n);if(i=r.tostr(i),e=a.join(i),o){var s=encodeURIComponent(n);s!=n&&(e=t.replacePlain(e,s,i))}}return e},t.replaceMap=function(e,n,i){return r.forIn(n,function(n,r){e=t.replacePlain(e,r,n,i)}),e},t.replaceTimeMacro=function(e,n){n=n||r.now();var i={"[timestamp]":n,"[M_timestamp]":n,"[TIMESTAMP]":n,"[randnum]":n,__timeStamp__:n,__TS__:n};return t.replaceMap(e,i,!0)},t.getCreativeType=function(e){var n=p.parse(e);if(n){var i=n.pathname,o=t.getExtname(i);return o=r.slice(o,1),f.lookup(o)}},t.getRenderType=function(e){var n=t.getCreativeType(e);return t.getRenderTypeByMime(n)},t.getRenderTypeByMime=function(e){return t.isMimeMatch(e,"image")?"image":t.isMimeMatch(e,"flash")?"swf":t.isMimeMatch(e,"video")?"video":t.isMimeMatch(e,"html")?"html":void 0},t.isCreativeType=function(e,n){var r=t.getCreativeType(e);return!(!r||!t.isMimeMatch(r,n))},t.isMimeMatch=function(e,t){return r.includes(e,t)},t.getExtname=function(e){e+="";var t=e.split(".");return"."+r.last(t)},t.setCursor=function(e,t){t?e.css({cursor:"pointer"}):e.css({cursor:""})},t.addAdBadge=function(e,n){t.addStyle(),n=n||{};var r=h('<span class="cupid-badge">{广告}</span>',v.resource),i=$(r);"bottom-left"==n.position?i.css({bottom:0,left:0}):i.css({top:0,left:0}),e.append(i)},t.loadImage=function(e,t){var n=new Image,o=$(n),a=r.once(function(){o.off("load").off("error")});return new i(function(i,s){o.on("load",function(){a(),i(n)}),o.on("error",function(){a(),s("error")}),t&&r.delay(function(){a(),s("timeout")},t),e=e.replace(/^http:/,""),o.attr("src",e)})},t.getAdInfo=function(e){e=e||{};var t=e.slot||{},n=e.creative||{},i=[t.cuepointType,e.dspId,e.orderItemId,n.creativeId,n.templateType];return i=r.map(i,function(e){return null==e&&(e=""),e}),i.join("||")},t.getScalingRange=function(e,t,n){e=e||{},t=t||{},t={width:l.number(t.width)?t.width:1/0,height:l.number(t.height)?t.height:1/0},n=n||{},n={width:n.width||0,height:n.height||0};var r=Math.max(n.width/e.width,n.height/e.height),i=Math.min(t.width/e.width,t.height/e.height);return r>i&&(r=i=NaN),{min:r,max:i}},t.getActionType=function(e){return r.get(e,"originalEvent.data.actionType")},t.isControlsAction=function(e){return"controls"==t.getActionType(e)},t.invisible=function(e){$(e).css({visibility:"hidden"})},t.visible=function(e){$(e).css({visibility:""})},t.humanizeDuration=function(e){var t=e,n=[],i=Math.floor(t/60/60);i>0&&(t-=60*i*60,n.push(i));var o=Math.floor(t/60);o>0&&(t-=60*o,n.push(o));var a=Math.floor(t);return n.push(a),n=r.map(n,function(e){return r.padStart(e,2,"0")}),n.join(":")},t.getQiyiResponseLevel=function(){var t=r.get(e,"Q.PageInfo.respInfo");if(t)return{responseLevel:t.curLayout||0,config:t.cnf}},t.tryAppend=function(e,t){var n=$(e),r=$(t);r.parent().get(0)!=n.get(0)&&n.append(r)},t.getPriceText=function(e){return e=parseFloat(e),isNaN(e)?"":"￥"+e},t.limitText=function(e,t){return e=r.trim(e),t&&e.length>t&&(e=r.slice(e,0,t-1)+String.fromCharCode(8230)),e},t.isHttps=function(){var t=r.get(e,"location.protocol");return!!/https/i.test(t)},t.normalizeProtocol=function(e){return l.string(e)&&(e=e.replace(/^(http:|https:)/,"")),e},t.countAdsDuration=function(e){return r.reduce(e,function(e,t){return t.error?e:e+t.duration},0)},t.convertMP4Url=function(e){var t=e.split("?"),n=g.parse(t[1]);return n.pv=.2,t[0]+"?"+g.stringify(n)},t.tryShowBlackScreen=function(e){a("show black screen");var n=o(e);n||setTimeout(function(){t.tryShowBlackScreen(e)},1e3)},t.isQiyiHost=function(){var e=p.parse(t.getPageUrl()).hostname;return!!r.endsWith(e,".iqiyi.com")},t.canUseCORS=function(){return!(!$.support.cors||!t.isQiyiHost())},t.isBaiduApp=function(){var e=new RegExp("/baidu/").test(window.location.href);return!(!window.__baiduApi__click||!e)},t.callBaiduClickApi=function(e){a("call baidu click api");try{window.__baiduApi__click(e)}catch(t){a("call baidu click api fail",t.message)}},t.parseXML=function(e){var t,n;try{n=new DOMParser,t=n.parseFromString(e,"text/xml")}catch(r){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||a("Invalid XML: "+e),t},t.promiseAll=function(e){var t=e.length;return 1===t&&e[0]instanceof i?e[0]:new i(function(n,o){function a(e,r){s[r]=e,c++,c===t&&n(s)}e instanceof Array||o("args requires an Array");var s=[],c=0;0===t&&n(s),r.each(e,function(e,t){e instanceof i?e.then(function(e){a(e,t)})["catch"](function(e){o(e)}):a(e,t)})})}}).call(t,function(){return this}(),n(7),n(25))},function(e,t){var n=function(e){return new RegExp('^[^\\x00-\\x20\\x7f\\(\\)<>@,;:\\\\\\"\\[\\]\\?=\\{\\}\\/\\u0080-\\uffff]+$').test(e)},r=function(e){if(n(e)){var t=new RegExp("(^| )"+e+"=([^;]*)(;|$)"),r=t.exec(document.cookie);if(r)return r[2]||null}return null},i=function(e){var t=r(e);return"string"==typeof t?t=decodeURIComponent(t):null};t.get=i},function(e,t,n){var r=n(77);e.exports=t=new r(["NO_ADZONE","CREATIVE_HTTP_ERROR","CREATIVE_TIMEOUT","BAD_CREATIVE_OBJECT","UNSUPPORTED_CREATIVE_TYPE","UNKNOWN_RENDER_TYPE"])},function(e,t,n){(function(n){function r(e){var t=this;t.index=0,i.array(e)?n.each(e,function(e){t.set(e,t.index),t.index++}):n.forIn(e,function(e,n){t.set(n,e)})}var i=n.is;e.exports=t=r;var o=r.prototype;o.set=function(e,t){var n=this;n[e]={key:e,value:t}}}).call(t,n(7))},function(e,t,n){(function(n){function r(e,t,n){var i=this;return i instanceof r?(Error.call(i,e),i.message=e,i.data=t,void(i.code=n)):new r(e,t,n)}e.exports=t=r,n.inherits(r,Error)}).call(t,n(7))},function(e,t,n){function r(e,t){var n="";return e=e.replace(t,function(e){return n=e,""}),[n,e]}function i(e,t){var n=[],r=s.indexOf(e,t);return-1==r?n[0]=e:(n[0]=e.slice(0,r),n[1]=e.slice(r+t.length)),n}function o(e){var t=i(e,"@"),n=t[0],r=t[1];return r||(r=t[0],n=null),[n,r]}var a=n(80),s=n(81);t.parse=function(e,t){if("string"!=typeof e)return e;var n,c,u={};u.href=e,n=i(e,"#"),c=n[0],n[1]&&(u.hash="#"+n[1]),n=r(c,/^[a-zA-Z][a-zA-Z0-9+-.]*:/),c=n[1],u.protocol=n[0].toLowerCase(),n=i(c,"?"),c=n[0];var d=n[1];if(t&&(d=a.parse(d)),u.query=d,"/"!=c.charAt(0)&&u.schema)return u.opaque=c,u;if(s.startsWith(c,"//")){c=c.slice(2),n=i(c,"/"),u.pathname="/"+unescape(n[1]||""),n=o(n[0]),u.auth=n[0];var l=n[1];n=i(l,":"),u.hostname=n[0],u.port=~~n[1]}return u};var c="http https ftp gopher file".split(" ");t.format=function(e){if(!e||"object"!=typeof e)return e;var t=e.protocol,n=[t];t&&!s.includes(c,t.slice(0,t.length-1))||n.push("//"),e.auth&&n.push(e.auth,"@"),n.push(e.hostname),e.port&&n.push(":",e.port),n.push(e.pathname);var r=e.query;r&&("string"!=typeof r&&(r=a.stringify(r)),r&&n.push("?",r)),n.push(e.hash);for(var i=[],o=0;o<n.length;o++)n[o]&&i.push(n[o]);return i.join("")}},[201,81],[190,82],[198,81,83,85,86,87,88,89,91,92],[191,84],10,[199,82],[195,82],[200,82],[192,82],[193,82,90],[194,82],[196,82],[197,82],function(e,t,n){(function(e){function n(t){t=e.lower(t);var n=e.keys(r);return e.find(n,function(n){return e.includes(r[n].extensions,t)})}var r={"image/jpeg":{extensions:["jpg","jpeg","jpe"]},"image/gif":{extensions:["gif"]},"image/png":{extensions:["png"]},"image/webp":{extensions:["webp"]},"application/x-shockwave-flash":{extensions:["swf"]},"video/mp4":{extensions:["mp4","mp4v","mpg4"]},"video/x-flv":{extensions:["flv"]},"video/x-f4v":{extensions:["f4v"]},"video/webm":{extensions:["webm"]},"text/html":{extensions:["html","htm","shtml"]}};t.lookup=function(e){return n(e)}}).call(t,n(7))},function(e,t,n){(function(n){function r(){this.resources={};var e=[];"object"==typeof navigator&&(e=navigator.languages||[navigator.language]),this.setLocales(e)}var i=r.prototype;i.is=function(e){return n.includes(n.lower(this.locale),n.lower(e))},i.setResource=function(e,t){this.resources[e]=t},i.setResources=function(e){n.extend(this.resources,e)},i.setLocale=function(e){var t=this;if(e){t.locale=e;var i=r.matchLocale(n.keys(t.resources),e);return t.resource=t.resources[i]||{},i}},i.setLocales=function(e){this.locales=e,this.setLocale(n.first(e))},i.translate=function(e){return this.resource[e]||e},r.matchLocale=function(e,t){e=n.map(e,function(e){return{raw:e,score:r.getSimilar(e,t)}}).sort(function(e,t){return e.score-t.score});var i=n.last(e)||{};return i.raw},r.getSimilar=function(e,t){var i=0;return e=r.parseLocale(n.lower(e)),t=r.parseLocale(n.lower(t)),e.language&&e.language==t.language&&(i+=50),e.country&&e.country==t.country&&(i+=40),e.language&&e.language==t.country&&(i+=20),t.language&&t.language==e.country&&(i+=20),i},r.parseLocale=function(e){var t=e.split(/[^a-zA-Z]+/),n={language:t[0],country:t[1]};return n};var o=new r;e.exports=t=o}).call(t,n(7))},function(e,t){function n(e,t,n){return t=t||{},n=n||{},(e+"").replace(r.interpolate,function(e,n){return t[n]||""})}var r={interpolate:/{([\s\S]+?)}/g};e.exports=t={template:n,templateSettings:r}},function(e,t,n){function r(e,t){var n=this;i.call(n),null==t&&(t=1/0),n.repeatCount=t,n.interval=e,n.reset()}var i=n(43),o=n(7);e.exports=t=r,o.inherits(r,i),r.interval=function(e,t,n){var i=new r(t,n);return i.on("timer",e),i.start(),i},r.timeout=function(e,t){return r.interval(e,t,1)};var a=r.prototype;a.start=function(){var e=this;e.running||(e.timer=setInterval(function(){e.currentCount++,e.emit("timer"),e.currentCount==e.repeatCount&&(e.emit("timerComplete"),e.stop())},e.interval)),e.running=!0},a.reset=function(){var e=this;e.stop(),e.currentCount=0},a.stop=function(){var e=this;e.running&&(clearInterval(e.timer),e.timer=null),e.running=!1}},function(e,t,n){t=e.exports=n(98)(),t.push([e.id,'.ares-tip{position:absolute;z-index:1000}.ares-tip .ares-tip-body{padding:10px;text-align:center}.ares-tip-basic{padding:5px 0}.ares-tip-basic .ares-tip-arrow{position:absolute;width:0;height:0;line-height:0;border:5px dashed #000;top:0;left:50%;margin-left:-5px;border-bottom-style:solid;border-top:none;border-left-color:transparent;border-right-color:transparent}.ares-tip-basic .ares-tip-body{background:#000;color:#fff}.ares-tip-border{padding:6px 0}.ares-tip-border .ares-tip-head{border:7px dashed transparent;border-bottom:7px solid #ddd;display:block;width:0;height:0;line-height:0;font-size:0;position:absolute;top:-7px;left:50%;margin-left:-5px}.ares-tip-border .ares-tip-head .ares-tip-arrow{position:absolute;border:6px dashed transparent;border-bottom:6px solid #fafafa;left:-6px;top:-5px}.ares-tip-border .ares-tip-body{background:#fafafa;border:1px solid #ddd}.video_ad{width:200px;height:200px;position:absolute;left:50%;margin-left:-100px;top:50%;margin-top:-100px}.video_ad-icon{width:27px;height:16px;border-radius:1px;background-color:rgba(0,0,0,.5);position:absolute;left:0;top:0;font-size:10px;color:#fff;line-height:16px;text-align:center}.video_ad-close{width:20px;height:20px;background:url(http://www.qiyipic.com/common/fix/videoplay/video_close.png) no-repeat;position:absolute;right:2px;top:2px;cursor:pointer}.video_pause{width:124px;height:42px;background-color:rgba(0,0,0,.8);padding:7px 10px 7px 46px;position:absolute;right:20px;bottom:50px}.video_pause-icon{width:67px;height:56px;background:url(http://www.qiyipic.com/common/fix/videoplay/video_pause.png) no-repeat;position:absolute;left:-28px;top:0}.video_pause p{height:21px;line-height:21px;font-size:14px;color:#fff;text-align:left}.video_pause-progress{width:0;height:56px;background-color:rgba(108,201,0,.5);position:absolute;left:0;top:0}@font-face{font-family:ds-digital;src:url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.eot);src:url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.eot?#iefix) format("embedded-opentype"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.woff) format("woff"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.ttf) format("truetype"),url(//static.qiyi.com/ext/common/pcWeb_fontFace/ds-digi-webfont.svg#iconfont) format("svg")}.public-time{position:absolute;z-index:100;background:rgba(26,26,26,.7);border-radius:20px;padding:0 15px;width:auto!important;height:30px;right:20px;top:20px;line-height:30px;text-align:center}.public-time span{font-size:20px;line-height:1.5;font-family:ds-digital!important;display:inline-block;position:relative;top:1px!important;color:#fff;width:40px;text-align:right}.h5-cupid.public-time{right:10px;top:10px;padding:0 10px;height:auto!important;line-height:26px}.h5-cupid.public-time span{font-size:17px;width:auto}.h5-cupid.public-time .public-vip{font-size:12px}.h5-cupid.public-time span{top:auto!important}.ad-theme-h5-new.h5-cupid.public-time{position:absolute;right:10px;top:10px;padding:0 11px;height:auto!important;line-height:30px;z-index:1000;background:rgba(30,30,30,.5);border-radius:20px;width:auto!important;text-align:center}.ad-theme-h5-new.h5-cupid.public-time span{width:auto;font-family:auto!important;color:#1cbe20;font-size:13px;top:auto!important}.ad-theme-h5-new.h5-cupid.public-time .public-vip{margin-left:0;font-size:12px}.ad-theme-h5-new.h5-cupid.public-time a{position:relative;top:auto}.public-time a{position:relative;top:-1px}.public-time .public-vip{margin-left:8px;color:#fff;font-size:14px}.public-time .public-vip:hover{color:#57a900}.public-vip .vip-marketing-doc{margin-left:8px;color:#c5955d}.public-vip:hover .vip-marketing-doc{color:#57a900}.tp_vip-show{width:623px;height:56px;line-height:56px;color:#c89e6c;font-size:18px;position:absolute;left:0;top:0;background:url(http://www.qiyipic.com/common/fix/view-tp/command.png) no-repeat;overflow:hidden;_background:0;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://www.qiyipic.com/common/fix/view-tp/command.png")}.tp_vip-show .tp_vip-gif{float:left;width:67px;height:56px;background:url(http://www.qiyipic.com/common/fix/view-tp/vip-tp.gif) no-repeat}.tp_vip-close{position:absolute;right:10px;top:15px;width:169px;height:30px;border-radius:2px;background-color:#434343}.tp_close-time{float:left;width:50px;border-right:1px solid #131313;text-align:center;color:#c89e6c;font:22px/30px ds-digital!important}.tp_close-txt{float:left}.tp_close-txt a{display:inline-block;width:117px;line-height:30px;color:#fff;font-size:14px;text-align:center;border-left:1px solid #3c3c3c}.tp_close-txt a:hover{color:#c89e6c}.tp_vip-time{top:28px;right:10px;width:50px;height:30px;text-align:center;color:#bbb;font:22px/30px ds-digital!important}.tp_vip-nointerest,.tp_vip-time{position:absolute;background-color:#333;background:rgba(51,51,51,.9);filter:alpha(opacity = 90);border-radius:2px}.tp_vip-nointerest{top:15px;right:75px;width:151px;height:55px}.tp_nointerest-top{color:#fff;text-align:center;line-height:30px;font-size:14px}.tp_nointerest-btm{color:#999;font-size:12px;line-height:20px;text-align:center;float:left}.tp_nointerest-btm span{float:left;width:40px;height:20px;color:#5aa700;font:25px/20px ds-digital!important}.tp_vip-detial{position:absolute;bottom:10px;right:10px;width:112px;height:35px;background-color:#333;background:rgba(51,51,51,.5);filter:alpha(opacity = 50);border-radius:2px}.tp_vip-detial a{display:inline-block;width:103px;height:35px;line-height:35px;padding-left:9px;color:#fff;font-size:16px}.tp_vip-detial span{position:absolute;right:5px;top:6px;width:23px;height:23px;background:url(http://www.qiyipic.com/common/fix/view-tp/detial.png) no-repeat;_background:0;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://www.qiyipic.com/common/fix/view-tp/detial.png")}.tp_vip-detial a:hover,.tp_vip-free a:hover{color:#5aa700}.tp_vip-detial a:hover span{background:url(http://www.qiyipic.com/common/fix/view-tp/detialhover.png) no-repeat;_background:0;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://www.qiyipic.com/common/fix/view-tp/detialhover.png")}.tp_vip-time1{top:15px}.tp_vip-free{position:absolute;top:15px;right:75px;text-align:center;background-color:#333;background:rgba(51,51,51,.9);filter:alpha(opacity = 90);border-radius:2px}.tp_vip-free a{display:inline-block;width:131px;height:30px;line-height:30px;color:#999;font-size:14px}.tp_disable-skip{position:absolute;right:10px;top:15px;height:30px;border-radius:2px}.tp_disable-skip-txt{float:left;padding:0 10px;background-color:#434343;border-radius:2px}.tp_disable-skip-txt a{display:inline-block;line-height:30px;color:#999;font-size:14px;text-align:center}.tp_disable-skip-time{float:left;margin-left:10px;width:35px;border-radius:2px;text-align:center;color:#999;background-color:#434343;font:16px/30px ds-digital!important}.tp_disable-skip-txt .tp_disable-skip-detail{width:16px;height:16px;line-height:16px;margin-left:5px;color:grey;border:1px solid;border-color:grey;border-radius:8px}.tp_disable-skip-detail:hover{color:#999;border-color:#999}.ares-tip{width:422px}.app-wrapper{border:1px solid #505050;display:block;width:278px;float:right;background-color:#444}.app-box{height:39px;border-radius:5px;margin:6px 10px 6px 11px}.app-wrapper img{width:38px;height:38px;border-radius:8px;float:left}.app-info{margin-left:48px;margin-right:85px}.app-title{font-size:15px;height:20px;color:#ddd;font-weight:600}.app-description,.app-title{line-height:20px;overflow:hidden}.app-description{font-size:12px;height:17px;color:#999}.app-btn{margin-top:6px;float:right;border-radius:3px;border-bottom:2px solid #517b00;box-shadow:1px 2px 8px 1px rgba(0,0,0,.25),1px 1px 4px hsla(0,0%,100%,.1);display:inline-block;line-height:24px;height:25px;width:72px;font-size:14px;text-align:center}.app-popup a,.app-wrapper a{color:#699f00}.app-highlight{overflow:hidden;text-overflow:ellipsis;color:#699f00}.app-popup .reverse,.app-wrapper .reverse{background-color:#699f00;color:#fff}.app-popup{line-height:30px;text-align:left;font-size:15px;margin:7px 0 7px 20px;width:390px}.app-popup:after,.app-popup div:after{clear:both;display:block;content:""}.app-section{width:180px}.app-right{margin-left:180px}.app-small{font-size:12px;color:#777;line-height:12px}.app-qrcode{padding:10px 20px 0;box-shadow:1px 2px 8px 1px hsla(0,0%,49%,.25),1px 1px 4px hsla(0,0%,100%,.1);text-align:center;float:left}.app-download{padding:0 15px;text-align:center;border-radius:3px;font-size:17px;font-weight:700;display:inline-block;line-height:29px}.app-popup-text1{font-weight:700;color:#666}.app-download-box{padding-bottom:14px}.app-mb10{margin-bottom:10px}.theatre-transition{transition:all .7s cubic-bezier(.46,.98,.54,1.1)}.theatre-label{background:#8ac024;width:84px;color:#fff;font-size:12px;text-align:center;line-height:22px;border-radius:4px 4px 0 0}.theatre-container{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;padding:10px 1px;width:100%;border:1px solid #8ac024;position:relative;overflow:hidden}.theatre-container img{display:block}.theatre-carousel-wrapper{height:140px;overflow:hidden;margin:0 auto}.theatre-carousel-box{width:5000px;height:170px;margin-left:-10px;display:inline-block;line-height:0}.theatre-hover .theatre-banner{opacity:1}.theatre-item{width:170px;overflow:hidden;transition:all .7s cubic-bezier(.46,.98,.54,1.1);float:left;margin:0 10px;background-color:#fff;cursor:pointer}.theatre-no-width{width:0;margin:0}.theatre-container .theatre-hover{width:930px;z-index:100}.theatre-expand{width:930px}.theatre-left{float:left;width:170px}.theatre-left img{width:100%}.theatre-poster{height:100px}.theatre-logo{height:40px}.theatre-right{float:left;margin-left:20px}.theatre-banner{opacity:0;transition:all .7s cubic-bezier(.46,.98,.54,1.1);width:740px}.theatre-arrow{width:15px;height:26px;cursor:pointer;text-indent:-999px;position:absolute;top:50%;margin-top:-13px}.theatre-arrow-left{left:4px;background:url("http://static.iqiyi.com/common/20150527/arrow-left.png") no-repeat 50%;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://static.iqiyi.com/common/20150527/arrow-left.png");_background:0}.theatre-arrow-left:hover{background:url("http://static.iqiyi.com/common/20150527/arrow-left-hover.png") no-repeat 50%;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://static.iqiyi.com/common/20150527/arrow-left-hover.png");_background:0}.theatre-arrow-right{right:4px;background:url("http://static.iqiyi.com/common/20150527/arrow-right.png") no-repeat 50%;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://static.iqiyi.com/common/20150527/arrow-right.png");_background:0}.theatre-arrow-right:hover{background:url("http://static.iqiyi.com/common/20150527/arrow-right-hover.png") no-repeat 50%;_filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true,sizingMethod=scale,src="http://static.iqiyi.com/common/20150527/arrow-right-hover.png");_background:0}.ad-arrow{display:inline-block;width:6px;height:6px;background:transparent;border-top:1px solid #fff;border-right:1px solid #fff;-webkit-transform:rotate(45deg);transform:rotate(45deg);margin:0 2px;vertical-align:1px}.cupid-learn-more{display:block;bottom:50px;right:10px;width:70px;line-height:2.2;background-color:rgba(26,26,26,.7)}.ad-theme-h5-new.cupid-learn-more,.cupid-learn-more{position:absolute;font-size:12px;border-radius:15px;text-align:center;color:#fff;z-index:1000}.ad-theme-h5-new.cupid-learn-more{bottom:10px;right:50px;width:80px;line-height:2.5;background-color:rgba(32,188,34,.8)}.cupid-badge{width:27px;height:16px;border-radius:1px;background-color:rgba(0,0,0,.5);position:absolute;font-size:10px;color:#fff;line-height:16px;text-align:center}.cupid-close{width:20px;height:20px;background:url(http://www.qiyipic.com/common/fix/videoplay/video_close.png) no-repeat;position:absolute;right:2px;top:2px;cursor:pointer}.cupid-summary-panel{font-family:monospace\\, consolas;padding:10px}.cupid-summary-panel ul{padding-left:40px}',""])},function(e,t){e.exports=function(){var e=[];return e.toString=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t];n[2]?e.push("@media "+n[2]+"{"+n[1]+"}"):e.push(n[1])}return e.join("")},e.i=function(t,n){"string"==typeof t&&(t=[[null,t,""]]);for(var r={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(r[o]=!0)}for(i=0;i<t.length;i++){var a=t[i];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),e.push(a))}},e}},function(e,t,n){function r(e,t){var n={};return e&&t&&o.forIn(t,function(t,s){var c=e[s];if(null!=c)if(a.object(c)){var u=c.type||i(t),d=c.name;"object"==u?n[d]=r(c.child,t):"array"==u&&(n[d]=o.map(t,function(e){return r(c.child,e)}))}else n[c]=t}),n}function i(e){return a._class(e)}var o=n(100),a=o.is;e.exports=t=o.curry(r)},[190,101],[198,100,102,104,105,106,107,108,110,111],[191,103],10,[199,101],[195,101],[200,101],[192,101],[193,101,109],[194,101],[196,101],[197,101],function(e,t){function n(e,t){var n=(65535&e)+(65535&t),r=(e>>16)+(t>>16)+(n>>16);return r<<16|65535&n}function r(e,t){return e<<t|e>>>32-t}function i(e,t,i,o,a,s){return n(r(n(n(t,e),n(o,s)),a),i)}function o(e,t,n,r,o,a,s){return i(t&n|~t&r,e,t,o,a,s)}function a(e,t,n,r,o,a,s){return i(t&r|n&~r,e,t,o,a,s)}function s(e,t,n,r,o,a,s){return i(t^n^r,e,t,o,a,s)}function c(e,t,n,r,o,a,s){return i(n^(t|~r),e,t,o,a,s)}function u(e,t){e[t>>5]|=128<<t%32,e[(t+64>>>9<<4)+14]=t;var r,i,u,d,l,p=1732584193,f=-271733879,v=-1732584194,h=271733878;for(r=0;r<e.length;r+=16)i=p,u=f,d=v,l=h,p=o(p,f,v,h,e[r],7,-680876936),h=o(h,p,f,v,e[r+1],12,-389564586),v=o(v,h,p,f,e[r+2],17,606105819),f=o(f,v,h,p,e[r+3],22,-1044525330),p=o(p,f,v,h,e[r+4],7,-176418897),h=o(h,p,f,v,e[r+5],12,1200080426),v=o(v,h,p,f,e[r+6],17,-1473231341),f=o(f,v,h,p,e[r+7],22,-45705983),p=o(p,f,v,h,e[r+8],7,1770035416),h=o(h,p,f,v,e[r+9],12,-1958414417),v=o(v,h,p,f,e[r+10],17,-42063),f=o(f,v,h,p,e[r+11],22,-1990404162),p=o(p,f,v,h,e[r+12],7,1804603682),h=o(h,p,f,v,e[r+13],12,-40341101),v=o(v,h,p,f,e[r+14],17,-1502002290),f=o(f,v,h,p,e[r+15],22,1236535329),p=a(p,f,v,h,e[r+1],5,-165796510),h=a(h,p,f,v,e[r+6],9,-1069501632),v=a(v,h,p,f,e[r+11],14,643717713),f=a(f,v,h,p,e[r],20,-373897302),p=a(p,f,v,h,e[r+5],5,-701558691),h=a(h,p,f,v,e[r+10],9,38016083),v=a(v,h,p,f,e[r+15],14,-660478335),f=a(f,v,h,p,e[r+4],20,-405537848),p=a(p,f,v,h,e[r+9],5,568446438),h=a(h,p,f,v,e[r+14],9,-1019803690),v=a(v,h,p,f,e[r+3],14,-187363961),f=a(f,v,h,p,e[r+8],20,1163531501),p=a(p,f,v,h,e[r+13],5,-1444681467),h=a(h,p,f,v,e[r+2],9,-51403784),v=a(v,h,p,f,e[r+7],14,1735328473),f=a(f,v,h,p,e[r+12],20,-1926607734),p=s(p,f,v,h,e[r+5],4,-378558),h=s(h,p,f,v,e[r+8],11,-2022574463),v=s(v,h,p,f,e[r+11],16,1839030562),f=s(f,v,h,p,e[r+14],23,-35309556),p=s(p,f,v,h,e[r+1],4,-1530992060),h=s(h,p,f,v,e[r+4],11,1272893353),v=s(v,h,p,f,e[r+7],16,-155497632),f=s(f,v,h,p,e[r+10],23,-1094730640),p=s(p,f,v,h,e[r+13],4,681279174),h=s(h,p,f,v,e[r],11,-358537222),v=s(v,h,p,f,e[r+3],16,-722521979),f=s(f,v,h,p,e[r+6],23,76029189),p=s(p,f,v,h,e[r+9],4,-640364487),h=s(h,p,f,v,e[r+12],11,-421815835),v=s(v,h,p,f,e[r+15],16,530742520),f=s(f,v,h,p,e[r+2],23,-995338651),p=c(p,f,v,h,e[r],6,-198630844),h=c(h,p,f,v,e[r+7],10,1126891415),v=c(v,h,p,f,e[r+14],15,-1416354905),f=c(f,v,h,p,e[r+5],21,-57434055),p=c(p,f,v,h,e[r+12],6,1700485571),h=c(h,p,f,v,e[r+3],10,-1894986606),v=c(v,h,p,f,e[r+10],15,-1051523),f=c(f,v,h,p,e[r+1],21,-2054922799),p=c(p,f,v,h,e[r+8],6,1873313359),h=c(h,p,f,v,e[r+15],10,-30611744),v=c(v,h,p,f,e[r+6],15,-1560198380),f=c(f,v,h,p,e[r+13],21,1309151649),p=c(p,f,v,h,e[r+4],6,-145523070),h=c(h,p,f,v,e[r+11],10,-1120210379),v=c(v,h,p,f,e[r+2],15,718787259),f=c(f,v,h,p,e[r+9],21,-343485551),p=n(p,i),f=n(f,u),v=n(v,d),h=n(h,l);return[p,f,v,h]}function d(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function l(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function p(e){return d(u(l(e),8*e.length))}function f(e,t){var n,r,i=l(e),o=[],a=[];for(o[15]=a[15]=void 0,i.length>16&&(i=u(i,8*e.length)),n=0;n<16;n+=1)o[n]=909522486^i[n],a[n]=1549556828^i[n];return r=u(o.concat(l(t)),512+8*t.length),d(u(a.concat(r),640))}function v(e){var t,n,r="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=r.charAt(t>>>4&15)+r.charAt(15&t);return i}function h(e){return unescape(encodeURIComponent(e))}function m(e){return p(h(e))}function g(e){return v(m(e))}function y(e,t){return f(h(e),h(t))}function b(e,t){return v(y(e,t))}function x(e,t,n){return t?n?y(t,e):b(t,e):n?m(e):g(e)}e.exports=x},function(e,t,n){(function(t,r){function i(e,t){var n=this;n.setParent(t),c.call(n,a),n.init(e),n.load()}function o(e,n){var r=e.getVal("unsupportedCuepointTypes");return t.filter(n,function(e){return!t.includes(r,e.cuepointType)})}var a="request",s=n(18)(a),c=n(42),u=n(114),d=n(148),l=n(60),p=n(112),f=n(74),v=n(58),h=t.is,m="requestId adBreaks requestIndex from".split(" ");e.exports=i,t.inherits(i,c);var g=i.prototype;g.getSummary=function(){var e=this;return"request: "+v.cuepoint2name[e.getCuepointType()]},g.isFirstRequest=function(){var e=this;return 0==e.index()},g.generateRequestId=function(){var e=this.view.videoEventId,n=[e,t.now()];return p(n.join(""))},g.init=function(e){s("init");var n=this;e=e||{},n.view=n.parent;var r=t.only(e,m);t.extend(n,r);var i=e.requestId||n.generateRequestId();return n.id=n.requestId=i,n.bindEvent(),n},g.getRequestName=function(){var e=this,t=e.getCuepointType();return v.cuepoint2name[t]},g.getRollName=function(){var e=this;if(e.isRoll())return e.getRequestName()},g.isPlayable=function(){var e=this;return t.some(e.children,function(e){return e.isPlayable()})},g.getCuepointType=function(){var e=this,n=t.first(e.cuepointList);if(n)return n.cuepointType},g.load=function(){var e=this,n=e.view,i=n.sdk;
return e.memory.load=e.memory.load||new r(function(a,c){e.setState("loading");var p=t.slice(e.adBreaks);e.adBreak=t.first(e.adBreaks);var m={};e.isFirstRequest()&&(m.needPolicy=!0,e.view.isVideoView()?(p.push({cuepointType:1}),i.isH5VideoMode()&&p.push({cuepointType:0})):p.push({cuepointType:0}));var g=o(e,p);if(!m.needPolicy&&h.empty(g))return s("empty request"),void e.setState("ended");e.cuepointList=p;var y=e.show=new u;y.init(e).setCuepointList(g).addEncryptionParam(m).request(function(o,u){if(o){e.setState("ended");var p=o,m=i.getUser().isVIP;if(e.isPreroll()&&!m){var g=p.errorCode;if(t.includes([301,304,305],g)){var y="preroll ad request blocked";s(y),/pad/i.test(i.deviceType)?(s("ipad show error notify h5 no ad"),n.notifyH5Player(v.event.EVENT_CUPID_NO_AD)):i.isH5VideoMode()?f.tryShowBlackScreen("adError"):i.isPCWVideoMode()&&i.emit("error",{subtype:"adblock",message:y}),l.send(e,{type:"statistics",subtype:"adblock",errorCode:g,errorMessage:p.errorMessage})}}c(o)}else e.runIfNotEnded(function(){e.result=u=t.extend({},u),u.slots=t.map(u.slots,function(t){return new d(t,e)}),n.schedule&&(h.empty(u.policySlots)||n.schedule.setPolicySlots(u.policySlots),n.schedule.setAutoChooseMidroll(u.midrollPoints));var i=e.findRollSlot(),o=e.getRollName();if(o){if("preroll"==o){var a=u.videoInfo;t.extend(n,a),e.setPrerollOrderItemIds()}i&&i.hasAds()?(n.sdk.isPCWVideoMode()?i.tryLoadToVideo().then(function(){n.emit("startLoadVideo",{reason:"load complete",rollType:o})},function(){n.emit("startLoadVideo",{reason:"load fail",rollType:o})}):n.sdk.isH5VideoMode()&&"preroll"==o&&i.tryLoadH5Roll().then(function(e){if(e){var o=t.first(e.ads);if(o)return i.bindH5VideoEvent(),void n.notifyH5Player(v.event.EVENT_CUPID_READY,e)}return r.reject("no-ad")}).caught(function(e){s("load h5 roll fail",e),n.notifyH5Player(v.event.EVENT_CUPID_NO_AD)}),i.isMidroll()&&(n.schedule.bindVideoTimeEvent(i.startTime-5,function(){n.sdk.video.startMidrollTip()}),e.view.lastMidrollRequestTime=i.startTime)):n.sdk.isPCWVideoMode()?(n.emit("startLoadVideo",{reason:"noad",rollType:o}),n.startVideo(o)):n.sdk.isH5VideoMode()&&"preroll"==o&&n.notifyH5Player(v.event.EVENT_CUPID_NO_AD)}}),a()})}),e.memory.load},g.setPrerollOrderItemIds=function(){var e=this,n=[],r=t.get(e,"result.slots");t.each(r,function(e){e.isPreroll()&&t.each(e.ads,function(e){n.push(e.orderItemId)})}),e.view.prerollOrderItemIds=n.join(",")},g.abort=function(){var e=this;e.show&&e.show.abort(),t.map(e.children,function(e){e.abort()}),e.setState("ended")},g.bindEvent=function(){var e=this;e.on("statechange",function(t){if(s("state change",t),"ended"==t&&(e.emit("inventory"),e.isRoll()&&(e.view.ended||e.view.startVideo(e.getRollName())),!e.isPlayable()&&e.isToolbar())){s("toolbar is empty and unbind mousemove");var n=e.view.sdk;n.unbindMouseMove()}}),e.once("inventory",function(){if(e.result&&e.result.inventory){s("send inventory");var n=t.only(e.result.inventory,"originalInventory rawInventory deliveredInventory forbiddenInventory");l.send(e,t.extend({type:"inventory",subtype:"success"},n))}else s("no data to send inventory")})},g.trySendInventoryDirectly=function(e){var n=this;n.inventoryOnVideoAdImpression=!1;var r=t.map(t.keys(t.reduce(e,function(e,t){return f.isEmptySlot(t)||(e[t.cuepointType]=!0),e},{})),function(e){return parseInt(e)}),i=!0,o=!1;h.empty(r)?o=!0:h.empty(t.without(r,0,8))?o=!0:i&&t.some(r,function(e){return f.isRoll(e)})&&(n.inventoryOnVideoAdImpression=!0),s("inventory on video ad impression",n.inventoryOnVideoAdImpression),o&&n.emit("inventory")},g.replay=function(){var e=this;e.reset(),e.play()},g.tryReplay=function(){var e=this;"ended"==e.state&&e.replay()},g.reset=function(){var e=this;s("reset"),e.off(),e.bindEvent(),e.setState("idle"),t.each(e.children,function(e){e.reset()})},g.play=function(){var e=this;"playing"!=e.state&&e.runIfNotEnded(function(){e.load().then(function(){return e._play()}).caught(function(e){s("error",e)})})},g.findRollSlot=function(){var e=t.get(this,"result.slots"),n=t.find(e,function(e){return f.isRoll(e.cuepointType)});return n},g._play=function(){var e=this,n=e.result;if(n){var r=t.reduce(e.cuepointList,function(e,r){var i=r.cuepointType;return e[i]=t.filter(n.slots,function(e){return e.cuepointType==i}),e},{});this.trySendInventoryDirectly(n.slots);var i=!1;t.forIn(r,function(n,r){if(r=parseInt(r),f.isRoll(r)||t.includes([4,6,7,9,10,11],r)){var o=n[0];o?(e.setState("playing"),o.play(),i=!0):e.setState("ended")}else t.includes([v.viewPoint],r)?e.initViewPoint(n):r==v.page?t.each(n,function(e){e.play()}):s("unsupport cuepoint type",r)})}i||e.setState("ended")},g.initViewPoint=function(e){var n=this,r=n.view.schedule;r&&f.isPageSupportViewPoint()?f.waitPageJobDone(function(){s("js job done");var i=[];if(t.each(e,function(e){t.each(e.ads,function(e){i.push(e)})}),!h.empty(i)){var o=t.map(i,function(e){var r=e.slot;n.view.viewPointAdZoneId=r.adZoneId;var i=e.creative.creativeObject;return e.exportAdObject=t.extend({startTime:r.startTime,badge:e.badge,adUid:e.id,source:1,orderItemId:e.orderItemId,dspIcon:e.icon},i),{ad:e,startTime:r.startTime,adZoneId:r.adZoneId,cuepointType:r.cuepointType}}),a=t.map(i,function(e){return e.exportAdObject});f.notifyPage("initAds",{ads:a,templateType:"viewPoint",adZoneId:n.view.viewPointAdZoneId,videoEventId:n.getVal("videoEventId")});var c=t.uniqBy(a,function(e){return e.startTime});n.view.notifyPlayer({viewPoints:c}),s("init viewpoint",o),r.addAdBreaks(o)}}):s("no schedule or page not support viewpoint")}}).call(t,n(7),n(25))},function(e,t,n){(function(t,r){function i(){var e=this;e.requestCount=0}function o(e){try{g.string(e)||(e=JSON.stringify(e));var t=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(t);return n}catch(r){}}var a=n(79),s=n(61),c=n(99),u=n(115),d=n(74),l=n(19).getLogger("show"),p=n(129),f=n(130),v=n(60),h=n(144),m=n(146),g=t.is;e.exports=i;var y={adPlayerId:"a",uaaUserId:"u",cupidUserId:"i",passportId:"p",requestId:"s",timestamp:"h",encryption:{name:"e",type:"object",child:{episodeId:"b",albumId:"l",channelId:"k",cuepointList:{name:"q",type:"array",child:{cuepointType:"ct",adZoneId:"zi",startTime:"st",sequenceId:"si",requestAdDuration:"rd",keyword:"kw",limit:"lm",skip:"sk"}},videoDuration:"d",referrer:"r",offline:"o",mobileKey:"t",userAgent:"m",continuingVideoPlayedCount:"n",continuingVideoPlayedDuration:"y",continuingAdPlayedDuration:"w",isVIP:"v",passportCookie:"pc",network:"nw",needPolicy:"po",encryptionVersion:"pv",isPreload:"pr",checkCode:"cc",checkCodeMethodVersion:"mv",url:"ul",videoPlayedDurationInDay:"cd",adPlayedDurationInDay:"ca",midrollPointsPlayedInView:"nm",lastRollCompleteInterval:"in",lastMidrollRequestTime:"lm",clientVersion:"cv",sdkVersion:"sv",supportIQiyiTracking:"gt",supportEmptyTracking:"ea",searchQuery:"sq",prerollOrderItemIds:"poi",pauseRequestTimes:"pt",playSource:"ps",requestIndex:"rix",videoEventId:"veid"}}};i.request=function(e,t){var n=new i;n.init(e).setCuepointList(t).request()},i.maxRequestCount=2,i.stringifyCuepointList=function(e){return t.map(e,function(e){return s.stringify(e,",",":")}).join(";")},i.compressRequestKey=c(y);var b=i.prototype;b.init=function(e){var t=this;return t.context=e,t.param={},t.encryptionParam=t.param.encryption={},t},b.addParam=function(e){var n=this;return t.extend(n.param,e),n},b.addEncryptionParam=function(e){var n=this;return t.extend(n.encryptionParam,e),n},b.setContextParam=function(){var e=this,n=e.context,i=n.view,o=i.sdk;o.updateUser();var s=t.extend({timestamp:t.now()},n.getMultiVals("adPlayerId uaaUserId passportId requestId".split(" ")));e.addParam(s);var c=a.parse(t.get(r,"document.referrer")||"")||{},u=t.extend({referrer:c.hostname,url:t.get(r,"location.href")},n.getMultiVals("episodeId albumId videoDuration isVIP encryptionVersion isPreload clientVersion sdkVersion supportIQiyiTracking searchQuery passportCookie supportEmptyTracking requestIndex videoEventId pauseRequestTimes prerollOrderItemIds playSource".split(" ")));if(e.addEncryptionParam(u),i.isVideoView()&&o.isPCWVideoMode()){var l=o.video,p=i.getContinuingViews(),f={continuingVideoPlayedCount:p.length,continuingVideoPlayedDuration:d.sumBy(p,"videoDuration"),continuingAdPlayedDuration:d.sumBy(p.concat(i),"adPlayedDurationInView")};e.addEncryptionParam(f);var v={adPlayedDurationInDay:h.data.adPlayedDurationInDay},m=l.videoPlayedDurationInDay();m&&(m=parseInt(m)),v.videoPlayedDurationInDay=m||0,n.isMidroll()&&(v.midrollPointsPlayedInView=i.midrollPointsPlayedInView,v.lastMidrollRequestTime=i.lastMidrollRequestTime,i.lastRollCompleteTime&&(v.lastRollCompleteInterval=Math.round((t.now()-i.lastRollCompleteTime)/1e3))),e.addEncryptionParam(v)}return e},b.normalizeRequestParam=function(){var e=this;return d.convertBoolInQuery(["needPolicy","supportIQiyiTracking","supportEmptyTracking","isVIP","isPreload"],e.encryptionParam),e},b.setCuepointList=function(e){var t=this;return t.encryptionParam.cuepointList=e,t},b.compressParamKey=function(){var e=this;return l.debug("request param",e.param),e.compressedParam=i.compressRequestKey(e.param),l.debug("compressed request param",t.extend({},e.compressedParam)),e.compressedParam.e.q=i.stringifyCuepointList(e.compressedParam.e.q),e},b.encryptRequestParam=function(){var e=this,t=e.context.getVal("adPlayerId"),n=s.stringify(e.compressedParam.e,"&","=",{keepRaw:!0});if(t&&n){var r;try{r=f.encryptBySeed(n,t)}catch(i){l.debug("encrypt error",n,t),r=""}e.compressedParam.e=r}return e},b.getPreviewParam=function(){var e=a.parse(t.get(r,"location.href"),!0).query,n="w y z".split(" "),i=t.only(e,n);if(t.keys(i).length==n.length)return i},b.getUrl=function(){var e=this,n=m.cupidUrl,r="/show2",i=e.compressedParam,o=e.previewParam=e.getPreviewParam();return o&&(l.debug("preview mode",o),r="/preview3",i=t.extend({},o,i)),e.url=n+r+"?"+s.stringify(i),e},b.request=function(e){var t=this;return t.setContextParam().normalizeRequestParam().compressParamKey().encryptRequestParam().getUrl()._request(e),t},b._request=function(e){function n(n,s){l.debug("status",n,a,s),r.requestCount++;var c={type:"show"},u=t.once(function(t,n){c.requestCount=-1,r.sendPingback(c),t&&(t=c),e(t,n)}),d="success"!=n;if(d)c.errorCode="timeout"==n?302:301,r.requestCount<i.maxRequestCount?(c.requestCount=r.requestCount,l.debug("request retry",r.requestCount),r._request(e)):(l.debug("request retry use up",i.maxRequestCount),u(new Error(n)));else{if(c.requestDuration=a,1==r.encryptionParam.encryptionVersion){l.debug("descrypt response");try{s=f.decryptShowResponse(r.url,s)}catch(v){l.debug("decrypt crash")}}var h=o(s);l.debug("response",s,h);var m=p.smartLoad(s);if(l.debug("humanize response",m),m.errorCode){var g={302400:305,302500:306,302503:307};c.errorCode=g[m.errorCode],c.errorMessage=m.serverError}else r.setSdkParamByShow(m);u(null,m)}}var r=this;l.debug("request",r.url);var a,s=t.now(),c=1e4;if(g.wechatApp())r.ajax=wx.request({url:r.url,dataType:"string",complete:function(e){a=t.now()-s,e=e||{};var r="success";/ok/.test(e.errMsg)||(r=a>c?"timeout":"error"),n(r,e.data)}});else{var u={url:r.url,dataType:"jsonp",jsonp:"cb",timeout:c,xhrFields:{withCredentials:!0},success:function(e,r,i){a=t.now()-s,n(r,e)},error:function(e,r,i){a=t.now()-s,n(r,i)}};d.canUseCORS()?(l.debug("qiyi host use json"),u.dataType="json"):l.debug("use jsonp"),r.ajax=$.ajax(u)}return r},b.sendPingback=function(e){var t=this;e.type="show",e.errorCode?e.subtype="error":e.subtype="success",v.send(t.context,e)},b.setSdkParamByShow=function(e){var n=this.context,r=n.getParentByName("sdk"),i=n.view;if(e.cupidUserId&&(r.cupidUserId=e.cupidUserId),e.pingbackParam&&(n.pingbackParam=e.pingbackParam),e.pingbackConfig&&(n.pingbackConfig=e.pingbackConfig),e.serverTime&&(d.deltaTime=e.serverTime-t.now()),e.clientIP){var o=u.atob(e.clientIP);l.debug("user ip",o),r.userIP=o}r.vipMarketingDocuments=t.slice(e.vipMarketingDocuments||"",0,7),e.videoInfo&&(i.disableSkipAd=e.videoInfo.disableSkipAd)},b.abort=function(){var e=this;e.ajax&&e.ajax.abort()}}).call(t,n(7),function(){return this}())},function(e,t,n){function r(e,t){var n=i(e,t);return f.encode(n)}function i(e,t){t=t||{};var n=h;t.useURL?n=m:null==t.useURL&&l(e)&&(n=m),e=e.replace(/\s+$/,"").replace(/=+$/,"").replace(/[\n\r]/g,"");for(var r=p.map(e.split(""),function(e){return~~n.decodeMap[e]}),i=[],o=0;o<r.length;o+=4){var a=c(p.slice(r,o,o+4));i.push.apply(i,a)}return i}function o(e,t){var n=f.decode(e);return a(n,t)}function a(e,t){t=t||{};var n=h;t.useURL&&(n=m);for(var r=[],i=0;i<e.length;i+=3)r.push.apply(r,s(p.slice(e,i,i+3)));return r=p.map(r,function(e){return n.encodeMap[e]||v}),r.join("")}function s(e){var t=[];return null==e[2]?t[3]=64:t[3]=63&e[2],null==e[1]?t[2]=64:t[2]=(15&e[1])<<2|e[2]>>6,t[1]=(3&e[0])<<4|e[1]>>4,t[0]=e[0]>>2,t}function c(e){var t=[];return null!=e[3]&&(t[2]=((3&e[2])<<6)+e[3]),null!=e[2]&&(t[1]=((15&e[1])<<4)+((60&e[2])>>2)),null!=e[1]&&(t[0]=(e[0]<<2)+((48&e[1])>>4)),t}function u(e){var t=d(e),n=p.invert(t);return{encodeMap:t,decodeMap:n}}function d(e){for(var t={},n=0;n<e.length;n++)t[n]=e.charAt(n);return t}function l(e){return/[-_]/.test(e)}var p=n(116),f=n(128);p.is;t.encode=t.btoa=o,t.decode=t.atob=r,t.encodeBytes=a,t.decodeToBytes=i;var v="=",h=u("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),m=u("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_")},[190,117],[198,116,118,120,121,122,123,124,126,127],[191,119],10,[199,117],[195,117],[200,117],[192,117],[193,117,125],[194,117],[196,117],[197,117],[202,116],function(e,t,n){(function(e){function r(e){}var i=n(99),o=e.is,a=n(74),s={v:"version",ics:"ipCollectionServers",cl:"clientIP",de:"serverIP",set:"serverTime",ec:"errorCode",sr:"serverError",ar:"areaId",ui:"cupidUserId",ntc:"needTimeChecking",vmd:"vipMarketingDocuments",ci:"cacheIP",idc:"idc",ims:"ims",inv:{name:"inventory",type:"object",child:{fi:"forbiddenInventory",ri:"rawInventory",oi:"originalInventory",di:"deliveredInventory"}},vcc:{name:"vipCheckConflict",type:"object",child:{v:"isVIP",c:"code",m:"message"}},pbp:"pingbackParam",m:{name:"midrollPoints",type:"object",child:{ac:"autoChoose",nm:"nextMidroll"}},pc:"pingbackConfig",vdi:{name:"videoInfo",type:"object",child:{dsa:"disableSkipAd",vd:"videoDuration",ai:"albumId"}},s:{name:"slots",type:"array",child:{ctp:"cuepointType",az:"adZoneId",st:"startTime",kw:"keyword",ea:{name:"emptyTracking",type:"object",child:{tss:"timeSlices",trp:"trackingParam"}},a:{name:"ads",type:"array",child:{comment:"comment",o:"order",ori:"orderItemId",tp:"timeSlices",p:"priority",hkw:"hitKeywords",dtp:"deliverType",ipt:"impressionTime",skt:"skipTime",bge:"badge",h:"host",se:"settle",ta:"targetedAd",ug:"userGroup",ds:"isDSP",dsi:"dspId",dst:"dspType",dsc:"dspIcon",oet:"orderItemEndTime",msm:"macroSubstitutionMap",ies:{name:"ies",type:"array",child:{dm:"domain",msm:"macroSubstitutionMap"}},va:{name:"vast",type:"object",child:{vo:"vastObject"}},rp:{name:"replay",type:"object",child:{rpt:"replayTimes",bst:"replayShowTime",bct:"replayCloseTime"}},cr:{name:"creative",type:"object",child:{cra:"creativeId",crb:"creativeType",crc:"creativeTemplate",tt:"templateType",co:"creativeObject"}},clt:"clickThrough",ctt:"clickThroughType",ct:{name:"clickTracking",type:"object",child:{at:"exchangeTracking",ctc:"cupidTracking",tpt:"thirdPartyTracking"}},it:{name:"impressionTracking",type:"object",child:{at:"exchangeTracking",ctc:"cupidTracking",tpt:"thirdPartyTracking"}},et:{name:"eventTracking",type:"array",child:{ev:"event",tr:"trackings"}},qt:{name:"iqiyiTracking",type:"object",child:{ct:{name:"cupidTracking",type:"object",child:{evs:"events",trp:"trackingParam"}},at:{name:"exchangeTracking",type:"object",child:{evs:"events",trp:"trackingParam"}}}}}}}},c:{name:"policySlots",type:"array",child:{az:"adZoneId",ctp:"cuepointType",sts:"startTimes",du:"duration",azl:"adZoneStyle"}},c_c_:"couponCode"};t.translate=i(s),t.decode=function(e){return e},t.normalize=function(){},t.smartLoad=function(n){var i={};if(n){if(o.string(n)){var s=e.first(n);"{"!=s&&(n=t.decode(n));try{n=a.parseJSON(n)}catch(c){}}if(o.object(n))return r(n),i=t.translate(n)}return i.error=new Error("parse error"),i}}).call(t,n(7))},function(e,t,n){function r(e,t){var n=h.decodeToBytes(e);n=f.map(n,function(e,n){return e^t.charCodeAt(n%t.length)});var r=m.encode(n);return r}function i(e,t){var n=m.decode(e);n=f.map(n,function(e,n){return e^t.charCodeAt(n%t.length)});var r=h.encodeBytes(n);return r}function o(e){var t=d(e),n=v.parse(t),i=n.a,o=n.e,a=r(o,i);return n.e=v.parse(a),n}function a(e){var t=o(e),n=t.e||{},r=0,i=0,a=parseInt(n.b),s=parseInt(n.l),c=f.last(t.a);a>100&&(r=parseInt(a/100%100)),s>100&&(i=parseInt(s/100%100));var u=r+"y"+c+"w"+i;return u}function s(e,t){var n=a(e);return i(t,n)}function c(e,t){var n=a(e),i=r(t,n);return i}function u(e,t){var n,r,i=/,"c_c_":"(\w+)"/,o=t.match(i);if(o){n=o[1];var a=t.replace(o[0],"");if(r=l(e,a),r==n)return!0}return!1}function d(e){var t=f.split(e,"?");return f.last(t)}function l(e,n){var r=g(n+t.SHOW_VERIFY_KEY+d(e)),i=p(n,r);return i}function p(e,t){t=f.split(t,"");for(var n,r=m.decode(e),i=Math.floor(r.length/2)-16,o=31;o>=1;--o){var a=r[i+o]%(o+1);o!=a&&(n=t[o],t[o]=t[a],t[a]=n)}return t.join("")}var f=n(7),v=n(61),h=n(115),m=n(131),g=n(112);t.decryptBySeed=r,t.encryptBySeed=i,t.decryptShowRequestByUrl=o,t.decryptShowResponse=c,t.encryptShowResponse=s,t.SHOW_VERIFY_KEY="cupid_show2.0",t.getShowCheckSum=l,t.validateShowChecksum=u},[202,132],[190,133],[198,132,134,136,137,138,139,140,142,143],[191,135],10,[199,133],[195,133],[200,133],[192,133],[193,133,141],[194,133],[196,133],[197,133],function(e,t,n){function r(){a("init");var e=s.data||{},t=new Date,n=t.getDay()!=new Date(e.timestamp).getDay();e.timestamp&&!n||i(),s.save()}function i(){a("reset"),s.data={timestamp:(new Date).getTime(),adPlayedDurationInDay:0,videoPlayedDurationInDay:0},s.save()}var o=n(145),a=n(18)("adstore"),s=o.useKey("ares");e.exports=s,r()},function(e,t){(function(n){function r(){}function i(e,t){var n=this;n.store=t,n.key=e,n.data=n.store.get(e)}var o=new r;e.exports=t=o;var a=r.prototype;n.JSON&&(a.parse=function(e){try{e=JSON.parse(e)}catch(t){}return e},a.stringify=function(e){try{e=JSON.stringify(e)}catch(t){}return e}),a.set=function(e,t){var n=this;n.stringify&&(t=n.stringify(t));try{localStorage[e]=t}catch(r){}},a.get=function(e){var t=this;try{var n=localStorage[e]}catch(r){}return t.parse&&(n=t.parse(n)),n},a.useKey=function(e){return new i(e,this)};var s=i.prototype;s.save=function(){var e=this;e.store.set(e.key,e.data)}}).call(t,function(){return this}())},function(e,t,n){var r=n(147);e.exports=new r},function(e,t,n){(function(t,r,i){function o(){var e=this;u.call(e,s);var n={sdkVersion:p+"-ares3",supportIQiyiTracking:!0,supportEmptyTracking:!0,encryptionVersion:"",isVideoSupportOverlay:!0,unsupportedCuepointTypes:a(),sdkUrl:t.get(r,"document.currentScript.src"),cupidUrl:"http://t7z.cupid.iqiyi.com",DEBUG:!1,isWechatApp:i.wechatApp()};l.isHttps()&&(n.cupidUrl="https://t7z.cupid.iqiyi.com"),c("config",n),t.extend(e,n),d.setLocale("zh-CN")}function a(){return t.map("3 5".split(" "),function(e){return parseInt(e)})}var s="global",c=n(18)(s),u=n(42),d=n(94),l=n(74),p="4.1.24";c("db mode: `__playertype__=h5` in query");var f={zh_CN:{"请您稍事休息":"请您稍事休息","广告之后更精彩哟~":"广告之后更精彩哟~","会员免广告":"会员免广告","了解详情":"了解详情","查看详情":"查看详情","广告":"广告","手机（选填）":"手机（选填）","邮件（选填）":"邮件（选填）","请简短说明一下您遇到的问题（选填）":"请简短说明一下您遇到的问题（选填）","提交":"提交","我知道了":"我知道了","收到！我们会尽快为您解决问题!":"收到！我们会尽快为您解决问题!","提交失败，请稍后重试":"提交失败，请稍后重试","应版权方要求，会员无法跳过该剧广告":"应版权方要求，会员无法跳过该剧广告","版权文案":"为了给大家提供更多优质的美剧资源，应版权方的要求，会员在观看《破产姐妹》、《吸血鬼日记》、《无耻之徒》等美剧时，无法跳过广告，我们会为会员用户继续争取跳广告的权益，非常抱歉，感谢大家的支持！"},tw:{"请您稍事休息":"請您稍事休息","广告之后更精彩哟~":"廣告之後更精彩喲~","会员免广告":"會員免廣告","了解详情":"了解詳情","查看详情":"查看詳情","广告":"廣告","手机（选填）":"手機（選填）","邮件（选填）":"郵箱（選填）","请简短说明一下您遇到的问题（选填）":"請簡短說明一下您遇到的問題（選填）","提交":"提交","我知道了":"我知道了","收到！我们会尽快为您解决问题!":"收到！我們會儘快為您解決問題！","提交失败，请稍后重试":"提交失敗，請稍後重試","应版权方要求，会员无法跳过该剧广告":"應版權方要求，會員無法跳過該劇廣告","版权文案":"為了給大家提供更多優質的美劇資源，應版權方的要求，會員在觀看《破產姐妹》、《吸血鬼日記》、《無恥之徒》等美劇時，無法跳過廣告，我們會為會員用戶繼續爭取跳廣告的權益，非常抱歉，感謝大家的支持！"}};d.setResources(f),t.inherits(o,u),e.exports=o}).call(t,n(7),function(){return this}(),n(23))},function(e,t,n){(function(t,r){function i(e,t){var n=this;s.call(n,o),n.setParent(t),n.request=t,n.init(e),n.bindEvent()}var o="slot",a=n(18)(o),s=n(42),c=n(74),u=n(149),d=n(152),l=n(58),p=n(166),f=n(169),v=n(170),h=n(94),m=t.is,g="ads cuepointType adZoneId startTime duration adzoneStyle emptyTracking".split(" ");e.exports=i,t.inherits(i,s);var y=i.prototype;y.getSummary=function(){var e=this;return"slot: "+l.cuepoint2name[e.cuepointType]},y.init=function(e){a("init");var n=this;e=e||{},n.request=n.parent;var r=t.only(e,g);t.extend(n,r);var i=e.ads;return i=t.filter(i,function(e){return null==e.host}),t.each(i,function(e){var r=t.extend({slot:n},e);new u(r,n)}),n.ads=n.children,n.hasInited=!0,n},y.hasAds=function(){var e=this;return!m.empty(e.ads)},y.abort=function(){var e=this;"ended"!=e.state&&(a("abort"),t.map(e.children,function(e){e.abort()}),e.end())},y.tryLoadToVideo=function(){var e=this;return t.reduce(e.ads,function(e,t){return e.then(function(){return t.tryLoadToVideo()})},r.resolve())},y.tryLoadH5Roll=function(){var e=this,n=e.getParentByName("sdk"),r=t.map(e.ads,function(e){return e.load().caught(function(e){a("bad video ad",e)})});return c.promiseAll(r).then(function(){var r=e.getVal("formatType"),i=t.filter(e.ads,function(e){return!e.error});if(e.duration=t.sum(t.map(i,function(e){return e.duration})),"m3u8"==r){var o=[],a=[];t.each(i,function(e){var t=e.matchedVideo;t&&(o.push(t.video),a.push({vid:t.video,tvid:e.creative.creativeObject.qipuid||""}))});var s=e.getVal("deviceType");if(/pad/i.test(s)||"tw"===h.locale){var u={vId:e.getVal("vId"),adVids:o,tvId:e.getVal("episodeId"),deviceType:s},d=new v(u);return d.request().then(function(t){t.adVids&&t.adVids.length>0&&n.removeInvalidAd({vid:t.adVids});var r={src:t.mu,ads:[{startTime:0,duration:e.duration}]};return r})}return{ads:a,tvId:e.getVal("episodeId"),duration:e.duration}}if("mp4"==r){var l=t.map(i,function(e){var t=e.matchedVideo;return{url:c.convertMP4Url(t.video),duration:e.duration,startTime:0}});return{ads:l}}})},y.bindH5VideoEvent=function(){var e=this,n=e.getParentByName("sdk"),r=n.video,i=e.getVal("formatType"),o=0,a=!1;if(r){var s=r.$video;if("mp4"==i){a=!0;var u=function(){if(r.currentTime()>.3){a=!1;var e=r.getCurrentAd();e&&e.template.onFirstPlaying(),s.off("timeupdate.ares",u)}};s.on("timeupdate.ares",u)}s.on("playing.ares timeupdate.ares error.ares",function(n){var u=r.intCurrentTime(),d="error"==n.type;if(d||u!=e.currentTime){e.currentTime=u;var l;if("m3u8"==i)l=t.find(e.ads,function(n,r){var i=c.countAdsDuration(t.slice(e.ads,0,r+1));return u<i});else if("mp4"==i){var p=c.getUrlBasename(r.src());l=t.find(e.ads,function(e){if(!e.isEnded()&&!e.error){var t=c.getUrlBasename(e.matchedVideo.video);if(t==p)return!0}return!1})}var f=r.getCurrentAd();r.setCurrentAd(l),f!=l&&f&&"m3u8"==i&&f.emit("video-ended"),l?a?d&&l.emit("video-"+n.type):(f!=l&&l.template&&l.template.onFirstPlaying(),l.emit("video-"+n.type)):(o+=1,o>=3&&(r.hideAllAdElements("没有匹配广告, 可能进入正片了"),s.off(".ares")))}})}},y.end=function(){var e=this;if(a("end"),e.isRoll()){var n=e.request.view;n.lastRollCompleteTime=t.now()}e.setState("ended"),e.emit("ended")},y.isLinear=function(){var e=this;return e.isRoll()},y.play=function(){var e=this,n=e.adZoneId;if(p.isTheatreSlot(e))e.theatre=new p(e),e.theatre.render();else if(e.isLinear()){var r=t.first(e.ads);r?r.play():e.complete()}else m.empty(e.ads)?f.DEFINITION_SWITCHING_SHOW!=n&&e.complete():t.each(e.ads,function(e){e.play()})},y.reset=function(){var e=this;e.setState("idle"),t.each(e.children,function(e){e.reset()})},y.bindEvent=function(){var e=this;return e.once("init",function(){e.initStatus()}),e.once("ended",function(){var n=e.cuepointType;if(c.isRoll(n)||t.includes([4,6,7,9,10,11],n)){var r=e.request;r.setState("ended")}}),e},y.isPlayable=function(){var e=this;return t.some(e.children,function(e){return e.isPlayable()})},y.hasImpressed=function(){var e=this;return t.some(e.children,function(e){return e.hasImpressed})},y.complete=function(){var e=this;if(a("complete"),e.sendEmptyTrackingBeforeTimeSlice(1/0),e.isMidroll()&&e.hasImpressed()){var t=e.request.adBreak;t&&!t.hasPlayed&&(t.hasPlayed=!0,e.request.view.midrollPointsPlayedInView++)}e.end()},y.getCuepointType=function(){var e=this;return e.cuepointType},y.sendEmptyTrackingBeforeTimeSlice=function(e){var n=this,r=n.emptyTracking||{};isNaN(e)||t.remove(r.timeSlices,function(i){var o=c.getFirstTimeSlice(i.w);if(!isNaN(o)&&o<=e){a("send empty tracking before",e,n.adZoneId);var s=t.extend({},i,r.trackingParam);return d.send({},s,n,"cupid","impression"),!0}})}}).call(t,n(7),n(25))},function(e,t,n){(function(t,r){function i(e,t){var n=this;y.call(n,d),n.playTimes=0,n.setParent(t),n.bindEvent(),n.iesKeyReplaced={},n.init(e),n.elements=[];var r=n.getParentByName("sdk");r&&(r.adMap[n.id]=n),n.isExternal&&(n.externalAdMap[n.id]=n)}function o(e){e.on("video-playing",function(){e.emit("playing")}),e.on("video-play",function(){e.play()}),e.on("video-loadstart",function(){e.emit("creativeLoad")}),e.on("video-pause",function(){e.pause()}),e.on("video-error",function(){e.template.emit("error",new k("video-error",{},I.CREATIVE_HTTP_ERROR))}),e.on("video-ended",function(){e.emit("complete",{type:"video-ended"})}),e.on("click",f.throttle(function(){return l("click",e),e.isExternal?m.click(e.creative.creativeId):void h.send(e,"click")},500,{trailing:!1})),e.once("impression",function(){if(!e.hasImpressed){if(e.isEnded())return void l("impression 失败, 广告已结束",e);if(l("impression",e),e.emit("creativeLoad"),e.hasImpressed=!0,e.handleConflict(),e.isExternal)return m.impression(e.creative.creativeId);e.slot.sendEmptyTrackingBeforeTimeSlice(g.getFirstTimeSlice(e.timeSlices)),h.send(e,"impression");var t=e.slot.request;t.inventoryOnVideoAdImpression?e.isRoll()&&t.emit("inventory"):t.emit("inventory"),e.isRoll()&&(l("roll ad start"),t.view.onNetworkFree(),e.emit("pingback",{subtype:"start"}),h.send(e,"start"))}}),e.once("trueview",function(){l("trueview",e),h.send(e,"trueview")}),e.on("skip",function(){l("click skip"),e.isTrueView()||e.isVIPAd()?l("not send skip click"):e.emit("pingback",{subtype:"skipClick"});var t=e.getParentByName("sdk"),n=t.video;if(t.getUser().isVIP||e.isTrueView()||e.isVIPAd())l("skip success"),e.emit("pingback",{subtype:"skip",customInfo:{ofs:e.getPlayedTime()}}),e.isTrueView()&&h.send(e,"skip"),n.pingback("ply_adskpd"),f.each(e.slot.ads,function(e){e.skipped=!0}),e.emit("end",{type:"skip"});else{t.isPCWVideoMode()&&n.exitFullscreen();var i=f.get(r,"Q.external.initVipPay");if(C.fn(i))l("support vip pay"),i({fc:"a3aa77e4bb08fdd9"});else{var o="http://serv.vip.iqiyi.com/order/preview.action?pid=a0226bd958843452&fc=a3aa77e4bb08fdd9";C.mobile()&&(o="http://serv.vip.iqiyi.com/order/preview.action?platform=97ae2982356f69d8&fc=bcaf702a7ccb128b&pid=a0226bd958843452&aid="+e.getVal("albumId")),f.includes(e.getVal("locale"),"tw")&&(o="http://serv.vip.iqiyi.com/order/preview.action?pid=af7de4c61c0a1805&qy_fr=WS-VIP-3102&app_lm=tw&platform=a31343b3762c80e7"),l("skip fail, open pay page",o),e.emit("open",o)}}}),e.once("creativeLoad",function(){return e.isExternal?m.creative({creativeId:e.creative.creativeId,subtype:"l"}):void v.send(e,{type:"creative",subtype:"load",customInfo:f.get(e,"matchedVideo.definitionLevel")})}),e.on("clickAndOpen",function(t,n){if(e.hasImpressed||e.isViewPoint()){e.emit("click");var r=setTimeout(function(){clearTimeout(r),e.emit("open",t,n)},300)}else l("has not impressed")}),e.on("open",f.throttle(function(t,n){if(l("open",e.format()),C.element(t)){var r=$(t);t=r.attr("href"),n=n||r.attr("target")}t=t||e.getUseableClickThrough(),g.isBaiduApp()?g.callBaiduClickApi(t):g.open(t,n)},500,{trailing:!1})),e.once("complete",function(t){l("complete"),e.isRoll()&&(T.data.adPlayedDurationInDay+=e.duration,T.save()),e.isPause()?e.slot.request.view.loadPause({requestIndex:e.getVal("requestIndex")+1,from:e}):e.emit("end",t)}),e.once("end",function(t){if(t=t||{},l("end by",t.type,e.format()),e.setState("ended"),e.template){var n={};"timer-complete"==t.type&&(n.abort=!0),e.template.stop(n)}e.isGeneralOverlay()&&e.slot.request.view.removeCurrentOverlayAd(e),f.each(e.elements,function(e){$(e).remove()}),e.emit("ended"),e.slot.hasInited&&(e.slot.isPage()||e.tryPlayNextAd())}),e.on("pingback",function(t){var n=f.map(e.slot.ads,function(e){return e.timeSlices.join("")}).join("|"),r=t.customInfo||{};r.rpt=e.playTimes-1;var i=e.getParentByName("request");i.adBreak&&(t.sequenceId=i.adBreak.sequenceId),t=f.extend({},t,{type:"ad",orderItemId:e.orderItemId,creativeId:e.creative.creativeId,dspId:e.dspId,adStrategy:[e.slot.cuepointType,e.timeSlices.join(""),n].join(":"),customInfo:P.stringify(r,",",":")}),v.send(e,t)}),e.on("creativeError",function(t,n){return e.isExternal?m.creative({creativeId:e.creative.creativeId,subtype:"e",errCode:n,errMsg:t,reqCount:-1}):void v.send(e,{type:"creative",subtype:"error",errorCode:n,errorMessage:t,requestCount:-1})}),e.on("error",function(t){t=t||{},l("error",t.message,t.data,e.format()),e.error=t;var n=t.code;if(I.CREATIVE_TIMEOUT==n||I.CREATIVE_HTTP_ERROR==n){var r=f.get(t,"data.creativeUrl"),i=I.CREATIVE_TIMEOUT==n?505:504;e.emit("creativeError",r,i)}setTimeout(function(){e.setState("error")})}),e.on("statechange",function(e){l("state change",e)}),e.on("bridge",function(){e.template&&e.template.emit.apply(e.template,arguments)})}function a(e){var t={};return f.forIn(e,function(e,n){if(C.string(e)&&(e=f.trim(e)),"true"==e)e=!0;else if("false"==e)e=!1;else{var r=parseFloat(e);r==e&&(e=r)}t[n]=e}),t}function s(e,t){return t=w.parse(t),!(t.hostname!=e&&!f.endsWith(t.hostname,"."+e))}function c(e){var t={};return f.each(e,function(e){if(e){var n=e.event;C.array(t[n])||(t[n]=[]),f.each(e.trackings,function(e){t[n].push(e)})}}),t}function u(e,t,n){return t=t||{},"theme"==e&&(t.url=n.creativeUrl||t.url),"giant_screen"==e&&(t.url=n.creativeUrl||t.url,t.width=t.width||n.creativeWidth,t.height=t.height||n.creativeHeight),t}var d="ad",l=n(18)(d),p=n(150),f=n(7),v=n(60),h=n(151),m=n(153),g=n(74),y=n(42),b=n(154),x=n(155),w=n(79),T=n(144),I=n(76),k=n(78),P=n(61);e.exports=i;var C=f.is;f.inherits(i,y);var A=i.prototype;A.getSummary=function(){var e=this,t=[e.creative.templateType,e.orderItemId,e.id];return t.join(" ")},A.init=function(e){var t=this;e=e||{},t.hasImpressed=!1,t.slot=t.parent,f.extend(t,e),t.id=f.compact(["ad",t.getVal("videoEventId"),p(),e.comment]).join("-"),t.timeSlices=f.split(t.timeSlices,","),t.impressionTracking=t.impressionTracking||{},t.clickTracking=t.clickTracking||{},t.eventTracking=c(t.eventTracking),t.creative=t.creative||{},t.tryParseAndMergeVastStr(f.get(t,"vast.vastObject")),t.creative.rawCreativeObject=t.creative.creativeObject,t.creative.creativeObject=a(t.creative.creativeObject),t.duration=t.creative.creativeObject.duration,t.initTemplate()},A.getDuration=function(){var e=this;return e.initTemplate().then(function(){return e.template.getDuration()})},A.tryLoadToVideo=function(){var e=this,t=e.load().then(function(){return e.isLiving(function(){return e.template.loadRollToVideo()})});return t["catch"](function(e){l("load to video fail",e)})},A.initTemplate=function(){var e=this;return e.tryTranslate().then(function(){return e.memory.initTemplate=e.memory.initTemplate||new t(function(t,n){e.template=x.init(e),e.template?(e.duration=e.template.getDuration(),isNaN(e.duration)?n(new k("invalid duration")):(e.isTrueView()&&(e.impressionTime=e.parseImpressionTime(e.impressionTime,e.duration),e.skipTime=e.parseSkipTime(e.skipTime,e.duration)),e.checkOnlyPlay(),t())):(v.send(e,{type:"statistics",subtype:"unsupported"}),n(new k("unknown template",f.get(e,"creative.templateType"))))}).caught(function(n){return e.emit("error",n),t.reject(n)}),e.memory.initTemplate})},A.normalizeTranslatorUrl=function(e){var t=this;e=g.replaceTimeMacro(e);var n=t.getParentByName("sdk"),r=n.video;
if(r){var i={"[PLAYER_WIDTH]":r.$video.width(),"[PLAYER_HEIGHT]":r.$video.height()};e=g.replaceMap(e,i)}return e},A.tryTranslate=function(){var e=this;return e.isLiving(function(){return e.memory.translate=e.memory.translate||new t(function(t,n){var r=e.creative.templateType;if("translator"==r){var i=e.creative.creativeObject,o=i.surl;o=e.normalizeTranslatorUrl(o),l("translate vast url",o),e.sendThirdPartyPingback();var a=f.now();$.ajax({url:o,xhrFields:{withCredentials:!0},dataType:"xml",timeout:2e3,complete:function(o,s){var c=f.now()-a;if(l("translate complete status",s),"success"==s){var u=i.template||{};e.creative.oldTemplateType=e.creative.templateType,r=e.creative.templateType=u.type,e.creative.creativeTemplate=u.url;var d=e.tryParseAndMergeVastStr(o.responseText);d&&d.creativeUrl&&("vpaid"==r?f.extend(i,{url:d.creativeUrl,adParameters:d.adParameters}):"crazy"==r?f.extend(i,{url:d.creativeUrl,isShowAdTips:"Yes"}):"roll"==r&&(i.finalUrl=d.creativeUrl),e.sendThirdPartyPingback({errorCode:900,requestDuration:c})),t()}else{var p=901;"timeout"==s&&(p=902),e.sendThirdPartyPingback({errorCode:p}),n(new Error("translator "+s))}}})}else t()}),e.memory.translate})},A.load=function(){var e=this;return e.initTemplate().then(function(){return e.memory.load=e.memory.load||new t(function(t,n){l("load"),e.setState("loading");var r=e.template.load();t(r)}),e.memory.load})},A.play=function(){var e=this;return e.isLiving(function(){return e.load()}).then(function(){return e.isLiving(function(){return"paused"==e.state?e.resume():"playing"!=e.state?e._play():void 0})}).caught(function(n){return e.error=e.error||n,l("play error",e.error),e.error&&e.emit("end",{type:"error"}),t.reject(n)})},A.resume=function(){var e=this;return e.isLiving(function(){l("resume"),e.setState("playing");var t=e.template;return C.fn(t.resume)?t.resume():t.play()})},A._play=function(){var e=this;return e.isLiving(function(){l("play"),e.playTimes++,e.setState("playing");var n=e.slot.request;return e.isPause()&&n.from&&n.from.abort(),e.isConflict()?t.reject(new Error("conflict")):(e.isGeneralOverlay()&&e.slot.request.view.addCurrentOverlayAd(e),e.template.play())})},A.isConflict=function(){var e=this;if(e.isGeneralOverlay()){var t=e.getVideo();if(t&&t.midrollTip.isVisible())return!0;var n=e.getVal("currentOverlayAds"),r=f.some(n,function(e){return e.isViewPoint()});if(r)return!0}return!1},A.handleConflict=function(){var e=this,t=e.getVal("currentOverlayAds");(e.isPause()||e.isMidroll())&&f.each(t,function(t){var n=t.$adzone;n&&n.hide(),e.isMidroll()&&t.pause()});var n=f.filter(t,function(t){if(e!=t){if(e.getVal("adZoneId")==t.getVal("adZoneId"))return!0;if(e.isViewPoint())return!0}return!1});f.each(n,function(t){l("same adzone conflict",e.format(),"kill",t.format()),t.abort()})},A.pause=function(){var e=this;return e.isLiving(function(){e.setState("paused"),e.template.pause()})},A.resize=function(){var e=this;return e.isLiving(function(){f.includes(["paused","playing"],e.state)&&e.template.resize()})},A.triggerExternalEvent=function(e,t){var n=this;if("onAdImpression"==e){if(n.isViewPoint()){l("impression viewpoint sidebar"),n.hasSidebarImpressioned||(n.hasSidebarImpressioned=!0,v.send(n,{type:"statistics",subtype:"impression",customInfo:"viewPointSidebar"}));var r=n.creative.creativeObject.impressionArea;"sidebar"==r&&n.emit("impression")}}else"onAdClick"==e&&(n.emit("click"),n.isViewPoint()&&(l("click viewpoint sidebar"),v.send(n,{type:"statistics",subtype:"click",customInfo:"viewPointSidebar"})))},A.reset=function(){var e=this;l("reset"),e.off(),e.bindEvent(),e.setState("idle"),e.isToolbar()&&(e.hasImpressed=!1);var t=e.template;t&&t.reset&&t.reset()},A.open=function(){var e=this;e.emit("open")},A.isPlayable=function(){var e=this;return!e.error},A.checkOnlyPlay=function(){var e=this,t=e.getVal("pageUrl"),n=f.get(t,"query.onlyplay");n&&(g.isAdMatch(e,n)?(l("onlyplay mode match and direct play",n),e.play()):e.emit("error",new k("ad is banned by onlyplay")))},A.abort=function(){var e=this;e.aborted=!0,l("abort"),e.emit("end",{type:"abort"})},A.getCuepointType=function(){var e=this;return e.slot.cuepointType},A.sendThirdPartyPingback=function(e){var t=this;v.send(t,f.extend({type:"statistics",subtype:"tps"},e))},A.tryParseAndMergeVastStr=function(e){var t=this;if(e){var n=b.parse(e);return l("parsed vast",n,e),n.isEmpty?(l("empty vast"),void t.sendThirdPartyPingback({errorCode:904,errorMessage:e})):n.error?(l("vast xml parse error",n.error),void t.sendThirdPartyPingback({errorCode:903,errorMessage:e})):(b.replaceMacro(n,t.settle),n.clickThrough&&(t.clickThrough=n.clickThrough),t.dspIcon||(t.dspIcon=n.icon),t.impressionTracking.thirdPartyTracking=f.union(t.impressionTracking.thirdPartyTracking,n.impressionTrackings),t.clickTracking.thirdPartyTracking=f.union(t.clickTracking.thirdPartyTracking,n.clickTrackings),f.forIn(n.eventTracking,function(e,n){t.eventTracking[n]=t.eventTracking[n]||[],t.eventTracking[n]=f.union(t.eventTracking[n],e)}),t.creative.creativeObject=u(t.creative.templateType,t.creative.creativeObject,n),n)}},A.canPlayNow=function(){var e=this;if(e.slot.isLinear()){var t=e.slot.ads[e.index()-1];if(t&&!t.isEnded()&&!t.error)return!1}return!0},A.bindEvent=function(){var e=this;return o(e),e},A.index=function(){var e=this;return f.indexOf(e.slot.ads,e)},A.format=function(){var e=this;return{adZoneId:e.slot.adZoneId,templateType:e.creative.templateType,orderItemId:e.orderItemId}},A.tryPlayNextAd=function(){var e=this,t=e.index(),n=e.slot.ads[t+1];n?n.skipped?n.tryPlayNextAd():(l("play next ad"),n.play()):e.skipped||e.aborted?e.slot.end():e.slot.complete()},A.replaceCommon3rdMacro=function(e,t){var n=this;e=e||"",e=f.trim(e);var r=n.getVal("userIP"),i=n.getVal("cupidUserId"),o=n.getVal("uaaUserId"),a={"[UDID]":i,"[M_IDFA]":o,"[IDFA]":i,"[IQIYI_HCID]":i,"[IQIYI_FCID]":o,"[QIYI_ID]":o,__UDID__:i,__IP__:r,"[M_ADIP]":r,"[M%5fADIP]":r,"[QIYI_AUTHCOOKIE]":n.getVal("passportCookie"),"[IQIYI_OFFSET]":n.getPlayedTime()};f.extend(a,n.macroSubstitutionMap);var c,u={},d=!0;f.each(f.compact(n.ies),function(r){var i=f.some(r.domain,function(t){return!!s(t,e)&&(c=t,!0)});if(i)if(isNaN(t))d=!0,u=f.extend(u,r.macroSubstitutionMap);else{var o=c+"_"+t;if(n.iesKeyReplaced[o])return d=!1,!1;var a=f.extend({},r.macroSubstitutionMap);for(var l in a)a[l]=a[l]+"_"+t;u=f.extend(u,a)}});var p=e;if(d&&!C.empty(u)&&(p=g.replaceMap(p,u,!0),l("replace url macro",e,p),p!==e)){var v=c+"_"+t;n.iesKeyReplaced[v]=!0}e=g.replaceMap(p,a,!0);var h=g.getCalibratedTime();return e=g.replaceTimeMacro(e,h)},A.replace3rdTrackingMacro=function(e,t){var n=this;return e=f.trim(n.replaceCommon3rdMacro(e,t))},A.replaceClickThroughMacro=function(e){var t=this,n=t.replaceCommon3rdMacro(e||t.clickThrough,1);return n},A.getUseableClickThrough=function(e){var t=this;return f.trim(t.replaceClickThroughMacro(e||t.clickThrough))},A.hasDspIcon=function(){var e=this;return!(1!=e.isDSP||!e.dspIcon)},A.putIcon=function(e,t){var n=this,r=25;return t=t||{},g.loadImage(e).then(function(i){return n.$adzone?(l("put icon",e),$(i).css({bottom:(t.bottom||0)+"px",left:(t.left||0)+"px",width:r+"px",height:r+"px",position:"absolute"}),n.$adzone.append(i),n.elements.push(i),i):new Error("no adzone")})},A.getAdInfo=function(){return g.getAdInfo(this)},A.getBaseInfo=function(){var e=this,t={id:e.id,orderItemId:e.orderItemId,adZoneId:e.slot.adZoneId,templateType:e.creative.templateType,startTime:e.slot.startTime};return t},A.getPlainInfo=function(){var e=this;return f.extend(e.getBaseInfo(),e.creative.creativeObject)},A.isPMP=function(){return 1==this.deliverType},A.isTrueView=function(){return 2==this.deliverType},A.isVIPAd=function(){return 3==this.deliverType},A.isOriginalRoll=function(){return 4==this.deliverType},A.parseImpressionTime=function(e,t){var n=f.endsWith(e,"%"),r=parseFloat(e);n&&(e=t*r/100);var i=e>=0&&e<=t;return i||(e=t/2),e=parseInt(e)},A.parseSkipTime=function(e,t){e=parseInt(e);var n=e>=0&&e<=t;return n||(e=Math.min(5,t)),e},A.getPlayedTime=function(){var e=this,t=e.duration||0,n=e.remain||0;return t-n}}).call(t,n(25),function(){return this}())},function(e,t){function n(e){return e=e||7,Math.random().toString(35).substr(2,e)}e.exports=n},function(e,t,n){(function(t){function r(e,t){var n=this;e instanceof o&&(n.context=e),n.eventName=s.normalizeEventName(t),n.eventCode=s.getEventCodeByName(n.eventName)}var i=n(18)("tracking"),o=n(42),a=n(74),s=n(152);e.exports=r,r.send=function(e,t){var n=new r(e,t);n.sendAll()};var c=r.prototype;c.sendAll=function(){var e=this;e.sendCupid(),e.sendExchange(),e.sendThirdParty()},c.sendCupid=function(){var e=this,n=e.context;if(n.isContext("ad")){var r=t.get(n,"iqiyiTracking.cupidTracking")||{};if(t.includes(r.events,e.eventCode)){var i=r.trackingParam;s.send({},i,n,"cupid",e.eventName)}}},c.sendExchange=function(){var e=this,n=e.context;if(n.isContext("ad")){var r=t.get(n,"iqiyiTracking.exchangeTracking")||{};if(t.includes(r.events,e.eventCode)){var i=r.trackingParam;s.send({},i,n,"exchange",e.eventName)}}},c.sendThirdParty=function(){var e=this,n=e.getThirdParty(),r=e.context.getVal("pingbackConfig")||{},o=t.keys(r);t.each(n,function(n){i("send","thirdParty",e.eventName,n);var c=t.find(o,function(e){return t.startsWith(n,e)});if(c){i("match pingback config",c);var u=new s;u.context=e.context,u.url=n,u.isQixiao=!0,u._send(function(){u.sendPingback(r[c])})}else a.ping(n)})},c.getThirdParty=function(){var e=this,n=e.context;if(!n.isContext("ad"))return[];var r=e.eventName,i=t.get(n,r+"Tracking.thirdPartyTracking"),o=t.get(n,["eventTracking",r]),a=t.compact(t.union(i,o));return t.map(a,function(t){return n.replace3rdTrackingMacro(t,e.eventCode)})}}).call(t,n(7))},function(e,t,n){(function(t){function r(){}var i=n(19).getLogger("qiyi-tracking"),o=n(74),a=n(42),s=n(99),c=n(112),u=n(61),d=n(60),l=n(146),p=t.is;e.exports=r;var f={impression:0,click:1,push:2,trueview:3,start:10,firstQuartile:11,midpoint:12,thirdQuartile:13,complete:14,downloadStart:20,downloaded:21},v={"1q":"firstQuartile",mid:"midpoint","3q":"thirdQuartile",stop:"complete",sp:"complete"},h={type:"a",timestamp:"b",videoEventId:"r",securityCode:"s",md5Version:"ve",uploadId:"up",clientVersion:"cv",sdkVersion:"sv",startTime:"st"},m=s(h);r.getEventCodeByName=function(e){var t=f[e];return t},r.normalizeEventName=function(e){return e=v[e]||e},r.send=function(e,t,n,i,o){var a=new r;a.init(n).addCompressedParam(t).addUncompressedParam(e).setType(i).setEvent(o).send(function(){a.sendPingback()})},r.encryptCupid=function(e){e.b=o.getTrackingTime();var n=t.map("a b c d r".split(" "),function(t){return e[t]});e.s=c(n.join("")+"cupid")},r.encryptExchange=function(e){e.b=o.getTrackingTime();var n=t.map("a v b c r d q".split(" "),function(t){return e[t]});e.s=c(n.join("")+"qax-track")},r.cupidUrl=l.cupidUrl+"/track2",r.exchangeUrl=l.cupidUrl+"/etx";var g=r.prototype;g.init=function(e){var t=this;return t.compressedParam={},t.uncompressedParam={},e instanceof a&&(t.context=e),t},g.addCompressedParam=function(e){return t.extend(this.compressedParam,e),this},g.addUncompressedParam=function(e){return t.extend(this.uncompressedParam,e),this},g.setType=function(e){var t=this,n="exchange"==e;return t.isExchange=n,t.type="cupid",n&&(t.type="exchange"),this},g.addFrontendParam=function(){var e=this,t={md5Version:1},n=e.context;return n&&(t.uploadId=n.getVal("uploadId"),t.clientVersion=n.getVal("clientVersion"),t.sdkVersion=n.getVal("sdkVersion"),t.videoEventId=n.getVal("videoEventId"),t.startTime=n.getVal("startTime")||0),e.addUncompressedParam(t),e},g.mergeUncompressedParam=function(){var e=this,n=m(e.uncompressedParam);return t.extend(e.compressedParam,n),e},g.setEvent=function(e){var t=this;return t.eventName=r.normalizeEventName(e),t.eventCode=r.getEventCodeByName(t.eventName),t.compressedParam.a=t.uncompressedParam.type=t.eventCode,t},g.encryptParam=function(){var e=this,t=r.encryptCupid;return e.isExchange&&(t=r.encryptExchange),t(e.compressedParam),e},g.getUrl=function(){var e=this,t=r.cupidUrl;return e.isExchange&&(t=r.exchangeUrl),t=t+"?"+u.stringify(e.compressedParam),e.url=t,e},g._send=function(e){var n=this;i.debug("send",n.type,n.eventName),i.verbose("verbose send",n.type,n.eventName,n.uncompressedParam,n.compressedParam,n.context.getInfo());var r=t.now(),a=n.url;return o.isHttps()&&(a=a.replace(/^http:/,"https:")),i.debug("url",a),$.ajax({url:a,dataType:"jsonp",jsonp:"cb",timeout:1e4,success:function(i,o,a){n.response={textStatus:o,duration:t.now()-r,data:i,status:o},e()},error:function(i,o,a){n.response={textStatus:o,duration:t.now()-r,data:a,status:o},e()}}),n},g.send=function(e){var t=this;return t.addFrontendParam().mergeUncompressedParam().encryptParam().getUrl()._send(e)},g.sendPingback=function(e){var n,r=this,a={type:"tracking",subtype:"success",requestCount:-1},s=r.response;t.includes(s.data,"ok")?(i.verbose("response success",s),a.requestDuration=s.duration):(i.error("error",s),a.subtype="error",n=601,"timeout"==s.textStatus?n=602:"success"!=s.textStatus&&(n=603)),r.isExchange?(a.type="exchange",p.number(n)&&(n+=500)):r.isQixiao&&(a.type=void 0,p.number(n)&&(n+=900)),a.errorCode=n;var c=r.context;r.context.isContext("slot")&&(c={slot:r.context}),a.adInfo=o.getAdInfo(c),d.send(r.context,a,e)}}).call(t,n(7))},function(e,t,n){function r(){return o||(o=$("#flash")[0]),!!o||(a("fail to find #flash"),!1)}function i(e,t){if(r())try{o[e](t),a(e,t)}catch(n){}}var o,a=n(18)("call-flash");t.click=function(e){i("onPageAdClickThrough",e),i("onPageAdClickPb",e)},t.impression=function(e){i("onPageAdImpression",e)},t.creative=function(e){e&&(e.type="c",i("onPageAdPb",e))}},function(e,t,n){(function(e){function r(t){return e.trim(t.text())}var i=n(74),o=e.is;t.parse=function(n){var a,s={};if(o.string(n))try{a=i.parseXML(n)}catch(c){s.error=c}else a=n;if(a){var u=$(a),d=u.find("Ad").eq(0),l=d.find("Wrapper"),p=d.find("InLine");l[0]&&(s.redirect=r(l.find("VASTAdTagURI")));var f=l[0]||p[0];if(f){var v=$(f);s.impressionTrackings=e.compact(e.map(v.find("Impression"),function(e){return r($(e))}));var h=v.find("Creatives").find("Creative").eq(0);if(h[0]){var m=h.find("Linear");s.duration=r(m.find("Duration")),s.adParameters=r(m.find("AdParameters")),s.clickThrough=r(m.find("VideoClicks").find("ClickThrough")),s.icon=r(m.find("Icons").find("Icon").find("StaticResource"));var g=m.find("MediaFiles").find("MediaFile");s.creativeUrl=r(g),s.creativeWidth=e.trim(g.attr("width")),s.creativeHeight=e.trim(g.attr("height")),s.clickTrackings=e.compact(e.map(m.find("VideoClicks").find("ClickTracking"),function(e){return r($(e))}));var y=m.find("TrackingEvents").find("Tracking"),b=s.eventTracking={};e.each(y,function(t){var n=$(t),i=e.trim(n.attr("event"));o.array(b[i])||(b[i]=[]);var a=r(n);a&&b[i].push(a)})}}}return s.isEmpty=t.isEmptyVast(a),s},t.isEmptyVast=function(e){return null==$(e).find("Ad").children()[0]},t.replaceMacro=function(t,n){if(t&&n){var r="${SETTLEMENT}";e.each("redirect clickThrough creativeUrl".split(" "),function(e){t[e]=i.replacePlain(t[e],r,n)}),t.clickTrackings=e.map(t.clickTrackings,function(e){return i.replacePlain(e,r,n)}),t.impressionTrackings=e.map(t.impressionTrackings,function(e){return i.replacePlain(e,r,n)}),e.mapValues(t.eventTracking,function(t,o){return e.map(t,function(e){return i.replacePlain(e,r,n)})})}return t},t.appendToAd=function(e,t){}}).call(t,n(7))},function(e,t,n){(function(e){var r=n(156),i=n(157),o=n(158),a=n(159),s=n(162),c=n(163),u={roll:r,relatedapp:r,h5_relatedapp:a,movieticket:c,html:s,theatre:i,image:o};t.init=function(t){var n=t.creative.templateType,r=u[n];if(e.mobile()&&"relatedapp"==n&&(r=a),r)return new r(t)}}).call(t,n(23))},function(e,t,n){(function(r,i){function o(e){var t=this;a.call(t,e);var n=t.creativeObject=e.creative.creativeObject;t.isTranslator()&&(e.creative.templateType="translator->"+e.creative.templateType,t.creativeUrl=n.finalUrl,t.log=c.getLogger(e.creative.templateType+":"+(e.orderItemId||e.id)));var i=e.getParentByName("sdk");i&&(t.video=i.video),t.video&&(t.$adContainer=i.video.$adContainer,t.$video=i.video.$video,e.$adzone=t.$adzone=t.$adContainer),e.$adzone.data("adzone",e.getVal("adZoneId")),t.effect={duration:500,type:"appear"},t.isOutVideo=!1,t.isRatioFixed=!0,t.canExpand=!0,t.waitingTimer=new l(1e3,15),t.waitingTimer.on("timerComplete",function(){t.video.paused()||(e.emit("error",new u("waiting too long",{creativeUrl:t.creativeUrl},d.CREATIVE_ERROR)),e.abort())}),t.on("error",function(n){n.data={creativeUrl:t.creativeUrl},e.emit("error",n),t.video&&t.video.getCurrentAd()==e&&e.abort()}),t.creativeUrl=t.creativeUrl||n.url,t.renderType="roll",t.renderType=t.renderType||n.renderType||s.getRenderType(t.creativeUrl),t.creativeMode=t.creativeMode||n.creativeMode,t.creativeMode=r.lower(t.creativeMode),t.size={},t.log.debug("render type",t.renderType,n,e.creative.templateType,t.creativeMode),r.includes(["roll"],t.renderType)||t.ad.emit("error",new u("unknown render type",{creativeUrl:t.creativeUrl},d.UNKNOWN_RENDER_TYPE)),t.hasPlaying=!1}var a=n(157),s=n(74),c=n(19).Log,u=n(78),d=n(76),l=n(96),p=n(151);e.exports=t=o,r.inherits(o,a);var f=o.prototype;f.load=function(){var e,t=this,n=t.ad,r=n.getParentByName("sdk");return new i(function(i,o){if(t.isEnded())return o(new Error("has ended"));t.log.debug("load");var a="mp4",c=r.formatType;"m3u8"==c&&(a="vid"),n.on("video-playing",function(){t.onFirstPlaying()});var l=s.chooseAdVideoByVideoDefinition(n.creative.creativeObject,n.slot.request.view.videoDefinition,a);l?(t.log.debug("matched ad video",l),t.creativeUrl=l.video,"mp4"==a&&(t.creativeUrl+="?pv=0.2"),n.matchedVideo=l,i()):(e=new u("fail to match ad video",n.creative.creativeObject,d.BAD_CREATIVE_OBJECT),n.emit("error",e),o(e))})},f.putOnDocument=function(){var e=this;e.$adzone&&(s.tryAppend(e.$adzone,e.creativeElement),e.$adzone.parent().get(0)||s.tryAppend(e.$adContainer,e.$adzone))},f.onFirstPlaying=function(){var e=this;if(!e.hasPlaying){e.hasPlaying=!0;var t=e.ad,n=t.slot.request,r=n.view;r.stopVideo(n.getRollName()),t.remain=t.duration,e.log.debug("on first playing"),e.ad.emit("impression"),e.initProgress(),e.slotDuration=s.countAdsDuration(t.slot.ads);var i={},o=e.video,a="normal";o.trySetOptions({theme:a,ad:t}),i.bottom=o.getControlsHeight()+10,i.left=25,t.hasDspIcon()&&t.putIcon(t.dspIcon,i),1==t.targetedAd&&(e.log.debug("precise ad and add icon"),t.putIcon("http://pic9.qiyipic.com/common/20161221/privacy.png",i).then(function(e){$(e).on("click",function(){s.open("http://www.iqiyi.com/common/secret.html")})})),1/0!=e.ad.duration&&e.updateCountdown()}},f.updateCountdown=function(){var e=this,t=e.ad;e.onFirstPlaying();var n=t.slot.ads,i=NaN,o=r.slice(n,t.index()+1);return i=t.remain+s.countAdsDuration(o),1==n.length?e.log.debug("countdown",t.remain+"/"+t.duration):e.log.debug("countdown",t.remain+"/"+t.duration,i+"/"+e.slotDuration),i<0?(e.log.debug("countdown < 0 不应该发生"),void t.abort()):void(isNaN(i)?e.log.debug("countdown NaN"):e.video.updateCountdown(i))},f.getDuration=function(){var e=this,t=e.creativeObject.duration;return t&&t!=1/0&&(t=parseInt(t)),t},f.initProgress=function(){var e=this,t=e.ad,n=[];n=[{position:.25,event:"1q"},{position:.5,event:"mid"},{position:.75,event:"3q"},{position:1,event:"sp"}];var i=r.once(function(){e.timer&&e.timer.stop(),e.timer=null,r.remove(n,function(e){return p.send(t,e.event),t.emit("pingback",{subtype:e.event}),!0});var i=e.getActualVideoLeftDuration();i>0&&i<1?setTimeout(function(){e.ad.emit("complete",{type:"timer-complete"})},1e3):e.ad.emit("complete",{type:"timer-complete"})}),o=e.getDuration();if(o>0&&1/0!=o){var a=t.getParentByName("sdk"),c=function(){var i=a.formatType,o=a.video.intCurrentTime();if("m3u8"==i){var c=s.countAdsDuration(r.slice(t.slot.ads,0,t.index()+1));t.remain=c-o}else"mp4"==i&&(t.remain=t.duration-o);e.updateCountdown();var u=t.getParentByName("view");u&&u.adPlayedDurationInView++,r.remove(n,function(n){var r=Math.round(t.duration*n.position);if(t.duration-t.remain==r)return e.log.debug("match quartile",n.event,r),p.send(t,n.event),t.emit("pingback",{subtype:n.event}),!0})};t.on("video-timeupdate",c)}t.on("video-playing",function(){e.timer&&!e.timer.running&&e.resume()}),t.on("video-ended",function(){i()})},f.loadRollToVideo=function(){var e=this;if(e.isRoll()){var t=e.ad,n=e.creativeUrl,r=e.video;t.once("video-waiting",function(){r.paused()||e.hasPlaying||e.waitingTimer&&e.waitingTimer.start()});var i=function(){e.waitingTimer&&e.waitingTimer.reset(),t.canPlayNow()?(e.onFirstPlaying(),t.off("video-playing",i)):e.log.debug("invalid playing")};t.on("video-playing",i);var o={file:n,id:t.id,offset:parseInt(t.slot.startTime),videoEventId:t.getVal("videoEventId")};e.log.debug("video load",o,o.videoEventId),r.load(o)}},f.play=function(){var e=this;return e._play()},f.tryStopLastAdByAdZone=function(){var e=this;if(e.$adzone){var t=e.$adzone.data("adId");if(t&&t!=e.ad.id){var n;if(e.ad.isExternal)n=e.ad.externalAdMap;else{var r=e.ad.getParentByName("sdk");r&&(n=r.adMap)}if(n){var i=n[t];i&&i.emit("complete",{type:"adzone-covered"})}}}},f._play=function(){var e=this;return new i(function(t,n){return e.log.debug("play"),e.isEnded()?n("ended"):t()})},f.resume=function(){var e=this;return e.log.debug("resume"),e.timer&&e.timer.start(),i.resolve()},f.pause=function(){var e=this;e.log.debug("pause"),e.timer&&e.timer.stop(),e.waitingTimer&&e.waitingTimer.stop()},f.getActualVideoLeftDuration=function(){var e=this.video,t=0;return e&&(t=e.duration()-e.currentTime()),t},f.stop=function(e){var t=this;e=e||{},t.log.debug("stop",e),t.timer&&t.timer.stop(),t.timer=null,t.waitingTimer&&t.waitingTimer.stop(),t.waitingTimer=null,t.checkTimer&&t.checkTimer.stop(),t.checkTimer=null,t.isStoped=!0,"left-to-right"==t.effect.direction?t.$adzone.animate({left:0-t.size.computedWidth+"px"},t.effect.duration,"swing",function(){t.destroyAdzone()}):t.destroyAdzone(),t.video&&t.video.getCurrentAd()==t.ad&&t.video.trySetOptions()},f.destroyAdzone=function(){var e=this;e.$adzone.removeAttr("data-adzone")},f.reset=function(){var e=this;e.isStoped=!1,e.hasPlaying=!1},f.resize=function(e){var t=this;if(!t.isEnded()){var n=t.size,r=t.creativeObject;t.video&&(n.videoWidth=t.$video.width(),n.videoHeight=t.$video.height()),n.creativeWidth=r.width,n.creativeHeight=r.height,n.creativeWidth=n.creativeWidth||t.size.creativeRawWidth||300,n.creativeHeight=n.creativeHeight||t.size.creativeRawHeight||250;var i=r.width==t.size.creativeRawWidth&&r.height==t.size.creativeRawHeight;if(i||t.log.debug("实际尺寸与填写尺寸不同"),t.isRatioFixed){var o=[600,500];n.boxWidth=r.width,n.boxHeight=r.height,n.boxWidth=n.boxWidth||o[0],n.boxHeight=n.boxHeight||o[1],n.boxWidth=Math.min(n.boxWidth,n.videoWidth),n.boxHeight=Math.min(n.boxHeight,n.videoHeight);var a=s.getScalingRange({width:n.creativeWidth,height:n.creativeHeight},{width:n.boxWidth,height:n.boxHeight});a.max&&(t.canExpand?n.scale=a.max:n.scale=Math.min(a.max,1),n.computedWidth=n.creativeWidth*n.scale,n.computedHeight=n.creativeHeight*n.scale)}else n.displayWidth=n.displayWidth||n.creativeWidth,n.displayHeight=n.displayHeight||n.creativeHeight,n.computedWidth=n.displayWidth,n.computedHeight=n.displayHeight;if(n.computedWidth&&n.computedHeight){t.setPosition();var c=n.x;e&&"left-to-right"==t.effect.direction&&(c=0-n.computedWidth),t.$adzone.css({width:n.computedWidth,height:n.computedHeight,top:n.y,left:c}),"move"==t.effect.type&&t.$adzone.animate({left:n.x+"px"},t.effect.duration,"swing")}else t.log.debug("fail to resize");t.log.debug("resize",n)}},f.setPosition=function(){var e=this,t=e.size,n=0,r=0;t.x=n,t.y=r},f.isEnded=function(){return this.isStoped}}).call(t,n(7),n(25))},function(e,t,n){(function(r,i){function o(e){var t=this;if(a.call(t),t.ad=e,t.creativeObject=e.creative.creativeObject,t.log=c.getLogger(e.creative.templateType+":"+(e.orderItemId||e.id)),t.ad.isPage()){var n=t.ad.getVal("adZoneId"),r=document.getElementById(n);if(!r)return t.ad.emit("error",new u("fail to find adzone",{adZoneId:n},d.NO_ADZONE)),void t.ad.abort();t.$adzone=$(r)}else t.$adzone=$("<div>");t.ad.isPage()&&t.log.debug("creativeObject",t.creativeObject),e.$adzone=t.$adzone}var a=n(43),s=n(74),c=n(19).Log,u=n(78),d=n(76);e.exports=t=o,r.inherits(o,a);var l=o.prototype;l.load=function(){return i.resolve()},l.emitCreativeError=function(e,t){var n=this.ad;"timeout"==e?n.emit("error",new u("creative timeout",{creativeUrl:t},d.CREATIVE_TIMEOUT)):n.emit("error",new u("creative http error",{creativeUrl:t},d.CREATIVE_HTTP_ERROR))},l.loadImage=function(e,t){var n=this;return t=t||3e4,s.loadImage(e,t).caught(function(t){return"timeout"===t?n.emitCreativeError("timeout",e):n.emitCreativeError("error",e),i.reject(t)})},l.getDuration=function(){return 1/0},l.onFirstPlaying=function(){var e=this;e.hasPlaying||(e.hasPlaying=!0,e.ad.isPage()&&e.$adzone&&e.$adzone.show().css({overflow:"hidden"}),e.ad.emit("impression"))},l.play=function(){},l.resume=function(){},l.abort=function(){},l.stop=function(){},l.pause=function(){this.ad.paused=!0},l.resize=function(){},l.getType=function(){return this.ad.creative.templateType},l.isRoll=function(){return"roll"==this.getType()},l.isTranslator=function(){return"translator"==this.getType()||"translator"==this.ad.creative.oldTemplateType}}).call(t,n(7),n(25))},function(e,t,n){(function(t,r){function i(e){var t=this;o.call(t,e)}var o=n(157),a=n(95).template,s=n(74);e.exports=i,t.inherits(i,o);var c=i.prototype;c.load=function(){var e=this;return e.ad.emit("creativeLoad"),e.loadImage(e.creativeObject.url).then(function(t){e.imageHeight=t.height,e.imageWidth=t.width})},c.play=function(){var e=this,t=e.creativeObject,n=$("<div>"),i=t.url.replace(/^http:/,"");e.ad.clickThrough&&(n=$("<a>"),n.attr({href:e.ad.clickThrough,target:"_blank"})),n.css({height:e.imageHeight+"px",position:"relative",display:"block",margin:"0 auto",background:a('url("{url}") 50% 50% no-repeat',{url:i})}).attr({href:e.ad.clickThrough||"",rel:"external nofollow"}),n.width()||n.css("width",e.imageWidth+"px"),0!=t.needAdBadge&&(e.log.debug("add ad badge"),s.addAdBadge(n));var o=e.$adzone;return o.empty().append(n),n.on("click",function(t){return e.ad.emit("clickAndOpen"),!1}),r.resolve().then(function(){return e.onFirstPlaying()})}}).call(t,n(7),n(25))},function(e,t,n){(function(t,r,i){function o(e){var t=this;a.call(t,e)}var a=n(157),s=n(95).template;e.exports=o,t.inherits(o,a);var c=o.prototype;c.load=function(){var e=this;return e.ad.emit("creativeLoad"),e.creativeObject.icon=e.creativeObject.icon.replace(/^http:/,""),e.loadImage(e.creativeObject.icon)},c.play=function(){var e=this,i=e.ad,o=i.getParentByName("sdk"),a=t.extend({},e.creativeObject);a.clickThrough=i.getUseableClickThrough()||"javascript:;",a.detailPage=a.detailPage||i.getUseableClickThrough()||"javascript:;";var c;return c="h5-new"===o.relatedTheme?s(n(160),a):s(n(161),a),e.$adzone.empty().append($(c)),i.once("impression",function(){e.sendRelatedAppLongyuanData("impression")}),i.on("relatedapp",function(t){e.sendRelatedAppLongyuanData(t)}),e.$adzone.find("a").filter(function(){var e=$(this),t=e.attr("href")||"";return t.length>2||void e.attr("href",null)}).on("click",function(){var e=$(this),t=e.attr("target");return"detail"==t?i.emit("relatedapp","detailPage"):i.emit("relatedapp","button"),i.emit("clickAndOpen",e.attr("href"),t),!1}),r.resolve().then(function(){return e.onFirstPlaying()})},c.sendRelatedAppLongyuanData=function(e){var t=this,n=t.ad||{},r=t.creativeObject,o="impression"==e,a={qpid:r.qipuid,appname:r.name,apptype:r.appType,frsale:n.dspType};o?a.t=21:(a.t=20,a.clickType=e);var s="searchADPingbackCallback";t.log.debug("send longyuan data",s,a);try{i[s](a)}catch(c){}}}).call(t,n(7),n(25),function(){return this}())},function(e,t){e.exports='<div class="m-box">\n    <div class="m-box-items m-box-items-full">\n        <div class="m-ipRelation m-ipRelation-full">\n            <ul class="ipRelation-list">\n                <li>\n                    <a href="{detailPage}" class="link-item">\n                        <div class="img" style="background-image:url({icon})">\n                            <div class="c-rt"><i class="c-picicon-s c-picicon-game">游戏</i></div>\n                        </div>\n                        <div class="info">\n                            <div class="c-title">{name}</div>\n                            <div class="c-des">{description}</div>\n                        </div>\n                    </a>\n                    <a href="{clickThrough}" class="c-handle-link">立即下载</a>\n                </li>\n        </div>\n    </div>\n</div\n'},function(e,t){e.exports='<div class="m-box-items m-box-items-full">\n    <div class="m-wl-entrance m-wl-borderT">\n        <a href="{detailPage}" class="m-wl-link" target="detail" rel="external nofollow">\n            <div class="wl-img"><img src="{icon}" width="100%" alt="{name}"></div>\n            <div class="info">\n                <div class="c-title">{name}</div>\n                <div class="c-des"><span class="c-tag">游戏</span>{description}</div>\n            </div>\n        </a>\n        <a href="{clickThrough}" class="c-btn" rel="external nofollow">下载</a>\n    </div>\n</div>\n'},function(e,t,n){(function(t,r,i){function o(e){var t=this;a.call(t,e)}var a=n(157),s=n(74);e.exports=o,t.inherits(o,a);var c=o.prototype;c.load=function(){var e=this;return e.ad.emit("creativeLoad"),r.resolve()},c.play=function(){var e=this,t=e.creativeObject,n=document.createElement("iframe"),o=$(n).hide();e.$adzone.empty().append(o);var a=i.string(o.prop("srcdoc"));if(a=!1,e.log.debug("is h5 iframe",a),o.attr({frameborder:0,scrolling:"no",height:150}).css({width:"100%"}).show(),t.srcdoc){e.log.debug("srcdoc",t.srcdoc);var c=n.contentDocument;if(a)o.attr("srcdoc",t.srcdoc);else try{c.write(t.srcdoc),c.close()}catch(u){}$(n.contentWindow).on("load",function(){$(c.body).css({margin:0,padding:0});var t=$("ins",c)[0];if(t){var n=parseInt(t.style.height,10);n&&n<=300&&(e.log.debug("ins autosize",n,t),o.attr({height:n}))}})}else t.src&&(s.isHttps()&&(t.src=t.src.replace(/^http:/,"https:")),e.log.debug("src",t.src),o.attr("src",t.src));return r.resolve().then(function(){return e.onFirstPlaying()})}}).call(t,n(7),n(25),n(23))},function(e,t,n){(function(t,r){function i(e){var t=this;o.call(t,e)}var o=n(157),a=n(95).template;e.exports=i,t.inherits(i,o);var s=i.prototype;s.load=function(){var e=this;return e.ad.emit("creativeLoad"),e.creativeObject.poster=e.creativeObject.poster.replace(/^http:/,""),e.loadImage(e.creativeObject.poster)},s.play=function(){var e=this,i=e.ad,o=i.getParentByName("sdk"),s=e.creativeObject,c=t.extend({},s),u="2D";c.imax?u="IMAX 3D":c["3d"]&&(u="3D"),c.dimension=u,c.clickThrough=e.ad.getUseableClickThrough()||"javascript:;";var d;return d="h5-new"===o.relatedTheme?a(n(164),c):a(n(165),c),e.$adzone.empty().append($(d)),e.$adzone.find("a").filter(function(){var e=$(this),t=e.attr("href")||"";return t.length>2||void e.attr("href",null)}).on("click",function(){var e=$(this);return i.emit("clickAndOpen",e.attr("href"),e.attr("target")),!1}),r.resolve().then(function(){return e.onFirstPlaying()})}}).call(t,n(7),n(25))},function(e,t){e.exports='<div class="m-box">\n    <div class="m-box-items m-box-items-full">\n        <div class="m-ipRelation m-ipRelation-full">\n            <ul class="ipRelation-list">\n                <li>\n                    <a href="{clickThrough}" class="link-item">\n                        <div class="img" style="background-image:url({poster})">\n                            <div class="c-rt"><i class="c-picicon-s c-picicon-film">电影票</i></div>\n                        </div>\n                        <div class="info">\n                            <div class="c-title c-title-row">{name}</div>\n                            <div class="c-des"><span class="c-score">{score}</span>{intro}</div>\n                            <div class="c-des"><span class="c-tag">{dimension}</span></div>\n                        </div>\n                    </a>\n                    <a href="{clickThrough}" class="c-handle-link">选座购票</a>\n                </li>\n        </div>\n    </div>\n</div>\n';
},function(e,t){e.exports='<div class="m-box m-box-bottom m-box-top">\n    <div class="m-box-items">\n        <div class="m-wl-entrance m-wl-largeImg">\n            <a href="{clickThrough}" class="m-wl-link" rel="external nofollow">\n                <div class="wl-img"><img src="{poster}" width="100%" alt="{name}"></div>\n                <div class="info">\n                    <div class="c-title">{name}</div>\n                    <div class="c-des">{intro}</div>\n                    <div class="c-des"><span class="c-tag">电影票</span><span class="c-tag">{dimension}</span>{score}</div>\n                </div>\n                <span class="c-btn">选座购票</span>\n            </a>\n        </div>\n    </div>\n</div>\n'},function(e,t,n){(function(t){function r(e){var t=this;t.log=u.getLogger("theatre:"+e.adZoneId),t.sum=8,t.cursor=0,t.slot=e;var n=document.getElementById(e.adZoneId);n?t.$adzone=$(n):t.error=new Error("fail to find adzone")}function i(e,t,n){var r=e.length,i=t+n,o=e.slice(t,i);if(t+n>r){i-=r;var a=e.slice(0,i);o=o.concat(a)}return o}var o=n(95).template,a=n(74),s=n(78),c=n(76),u=n(19).Log,d=t.is,l="bannerUrl logoUrl posterUrl".split(" "),p=170,f=20,v=15;e.exports=r,r.isTheatreSlot=function(e){var n=t.first(e.ads);return!(!n||"theatre"!=n.creative.templateType)};var h=r.prototype;h.resize=function(){var e=this;if(!e.error){var t=e.$adzone.find(".theatre-container").width();e.log.debug("resize","box width",t);var n=(t-2*v+f-8)/(p+f);n=Math.floor(n),n=Math.max(5,n),n=Math.min(8,n),n!=e.sum&&(e.sum=n,e.drawItems())}},h.drawItems=function(){var e=this;e.log.debug("draw items"),e.curItems=i(e.items,e.cursor,e.sum);var n=t.map(e.curItems,function(e){return e.element});e.$adzone.find(".theatre-carousel-box").empty().append($(n)),t.each(e.curItems,function(e){e.ad.emit("creativeLoad"),e.ad.emit("impression")}),e.$adzone.find(".theatre-carousel-wrapper").css("width",p*e.sum+f*(e.sum-1))},h.render=function(){function e(e){var n=$(e);n.hasClass("theatre-item")||(n=n.parents(".theatre-item").eq(0));var r=n.attr("href");return t.find(i.items,function(e){return r==e.clickThrough})}function r(){$(window).on("resize",t.throttle(function(){setTimeout(function(){i.resize()},300)},1e3)),p.on("mouseenter",".theatre-item",function(){var e=$(this),n=e.data("isHover");if(!n){e.addClass("theatre-hover"),e.data("isHover",!0),i.log.debug("mouseenter");var r,o,a,s=e.index();s<=4?(r=i.curItems.slice(0,s),a=4-r.length,o=i.curItems.slice(i.sum-a,i.sum)):(o=i.curItems.slice(s+1,i.sum),a=4-o.length,r=i.curItems.slice(0,a)),$(t.map(r.concat(o),function(e){return e.element})).addClass("theatre-no-width")}}).on("mouseleave",".theatre-item",function(){i.log.debug("mouseleave");var e=$(this);e.data("isHover",!1),e.removeClass("theatre-hover"),p.find(".theatre-no-width").removeClass("theatre-no-width")}),i.$adzone.find(".theatre-arrow").on("click",function(){var e=$(this);e.hasClass("theatre-arrow-right")?(i.log.debug("arrow right"),i.cursor=i.cursor+i.curItems.length,i.cursor>=i.items.length&&(i.cursor-=i.items.length)):(i.log.debug("arrow left"),i.cursor=i.cursor-i.curItems.length,i.cursor<0&&(i.cursor+=i.items.length)),i.log.debug("cursor",i.cursor),i.drawItems()}),p.on("click",".theatre-item",function(){var t=e(this);return t&&t.ad.emit("clickAndOpen"),!1});var n=$(t.map(i.items,function(e){return e.element}));n.find("img").one("error",function(){var t=e(this);if(t){var n=$(this).attr("src");t.ad.emit("error",new s("creative http error",{creativeUrl:n},c.CREATIVE_HTTP_ERROR))}})}var i=this;if(!i.error){var u=i.slot;i.log.debug("render",u),i.items=t.compact(t.map(u.ads,function(e){var n=e.creative.creativeObject||{},r=t.every(l,function(e){return!d.empty(t.trim(n[e]))});return r?t.extend({ad:e},t.only(n,l),t.only(e,"clickThrough")):void i.log.error("error creative object",e.format())})),i.items=t.shuffle(i.items),i.curItems=[],i.log.debug("data",i.items),t.each(i.items,function(e){var t=o(n(167),e);e.element=$.parseHTML(t)[0]}),i.$adzone.empty().html(n(168)).show().css({opacity:1});var p=i.$adzone.find(".theatre-carousel-box");a.addStyle(),r(),i.resize()}}}).call(t,n(7))},function(e,t){e.exports='<a href="{clickThrough}" target="_blank" class="theatre-item" rel="external nofollow">\n    <div class="theatre-expand">\n        <div class="theatre-left">\n            <img src="{posterUrl}" class="theatre-poster">\n            <img src="{logoUrl}" class="theatre-logo">\n        </div>\n        <div class="theatre-right"><img src="{bannerUrl}" class="theatre-banner"></div>\n    </div>\n</a>\n'},function(e,t){e.exports='<div class="theatre-label">推广广告</div>\n<div class="theatre-container" style="">\n    <div class="theatre-arrow-left theatre-arrow"></div>\n    <div class="theatre-carousel-wrapper">\n        <div class="theatre-carousel-box"></div>\n    </div>\n    <div class="theatre-arrow-right theatre-arrow"></div>\n</div>\n'},function(e,t){t.DEFINITION_SWITCHING_SHOW=0xe8d4a512a0,t.CLICK="click",t.IMPRESSION="impression"},function(e,t,n){(function(t,r){function i(e){var t=this;a("init",e),t.vId=e.vId||"",t.adVids=e.adVids||[],t.tvId=e.tvId||"",t.deviceType=e.deviceType}function o(e,t){return new r(function(n,r){$.ajax({url:e,data:t.data,timeout:5e3,xhrFields:{withCredentials:!0},dataType:"json",success:function(e,t,r){n(e)},error:function(i,a){t.shouldRetry?(t.shouldRetry=!1,n(o(e,t))):r(a)}})})}var a=n(18)("amt"),s=n(94),c=n(95),u=n(61),d=n(74),l=d.normalizeProtocol("http://cache.m.iqiyi.com");e.exports=i;var p=i.prototype;p.request=function(){var e=this,n=e.getUrl();return a("request",n),o(n,{shouldRetry:!0}).then(function(e){var n=e;a("m3u8 request",e);var i=t.get(n,"data.mu");return i?e.data:r.reject(e)})},p.getUrl=function(){var e=this,t=/pad/i.test(e.deviceType),n=t?21:31,r=t?"03020031010000000000":"02020031010000000000";s.is("tw")&&(r="02020031010010000000");var i={tvId:e.tvId,adVids:e.adVids.join("-"),vId:e.vId},o=c.template("/dc/amt/{adVids}/{tvId}/{vId}/",i);o=e.signaturePath(o,{qypid:e.tvId+"_"+n,src:r});var a=l+o;return a},p.signaturePath=function(e,n){if("function"==typeof cmd5xtmts&&"function"==typeof cmd5x){var r,i;try{r=window.cmd5xtmts()}catch(o){i=o}if(!i){t.extend(n,r),e+="?"+u.stringify(n);var s="";try{s=window.cmd5x(e)}catch(o){i=o}e+="&vf="+s}i&&a("error: signature error",i)}return e}}).call(t,n(7),n(25))},function(e,t,n){(function(r){function i(e){var t=this;d.call(t),t.view=e,t.video=e.sdk.video,t.midrollPoints={},t.adBreaks=[],t.allAdBreaks=[],t.timerHandler=function(e){t.currentTime=t.video.intCurrentTime();var n=c.getActionType(e);if("seeked"==e.type&&(s("seeked",t.currentTime,n),"controls"==n&&(t.onUserSeeked(),t.disableAutoChooseMidroll("用户 seek 了"))),null==t.lastTime){var i=r.get(t,"midrollPoints.nextMidroll");i>0&&i<t.currentTime&&t.disableAutoChooseMidroll("开播时间晚于自动中插点")}t.lastTime!=t.currentTime&&t.updateVideoTime(e)},t.running=!1}function o(e){var t=[];return r.each(e,function(e){p.empty(e.startTimes)?t.push(new l({cuepointType:e.cuepointType,adZoneId:e.adZoneId,adZoneStyle:e.adZoneStyle})):r.each(e.startTimes,function(n,r){t.push(new l({startTime:n,cuepointType:e.cuepointType,adZoneId:e.adZoneId,sequenceId:r+1,adZoneStyle:e.adZoneStyle}))})}),t}function a(e){var t=r.map(e,function(e){return e.priority}),n=r.max(t);return e=r.filter(e,function(e){return n==e.priority||(e.state="banned",!1)})}var s=n(18)("schedule"),c=n(74),u=n(58),d=n(43),l=n(172),p=r.is;e.exports=t=i,r.inherits(i,d);var f=i.prototype;f.setPolicySlots=function(e){var t=this;t.allAdBreaks=o(e),t.adBreaks=t.allAdBreaks.filter(function(e){return e.isMid()}),t.prettyAdBreaks(),s("set policy slots",t.adBreaks)},f.addAdBreak=function(e){return this.addAdBreaks([e])},f.addAdBreaks=function(e){var t=this;e=r.map(e,function(e){return new l(e)}),r.each(e,function(e){e.isValid()&&t.adBreaks.push(e)}),t.prettyAdBreaks(),s("add ad breaks",t.adBreaks)},f.getAdBreaksByType=function(e){var t=this;return r.filter(t.allAdBreaks,function(t){return r.isMatch(t,{cuepointType:e})})},f.startTimer=function(){var e=this;e.running||(s("start timer"),e.video.on("timeupdate",e.timerHandler),e.video.on("seeked",e.timerHandler),e.video.on("play",function(){if(e.running){var t=e.video.currentTime();s("video play",t);var n=e.midrollPoints;if(n&&n.autoChoose){var r=n.nextMidroll;-1!=r&&r<t&&e.disableAutoChooseMidroll("自动中插点在当前时间前面")}}}),e.running=!0)},f.stopTimer=function(){var e=this;e.running&&(s("stop timer"),e.video.off("timeupdate",e.timerHandler),e.video.off("seeked",e.timerHandler),e.running=!1)},f.bindVideoTimeEvent=function(e,t){this.on("videotime:"+e,t)},f.emitVideoTimeEvent=function(e){this.emit("videotime:"+e)},f.updateVideoTime=function(e){var t=this;0==t.currentTime%10&&s("update",t.currentTime),t.emitVideoTimeEvent(t.currentTime),t.lastTime=t.currentTime,t.adBreaksTimeHandler()},f.adBreaksTimeHandler=function(){var e=this,t=[],n=[];r.each(e.adBreaks,function(r){"banned"!=r.state&&(r.isLoaded()||r.canLoad(e.currentTime)&&t.push(r),r.isLoaded()&&e.currentTime==r.startTime&&n.push(r))});var i=a(t),o=a(n);i.length!=t.length&&s("adbreaks to load conflict",i,t),o.length!=n.length&&s("adbreaks to play conflict",o,n),r.each(i,function(t){s("adbreak load and fill",t),t.fill(e.view)}),r.each(o,function(e){s("adbreak play",e);var t=e.request,n=e.ad;t?t.play():n&&(n.slot.request.reset(),n.play())})},f.onUserSeeked=function(){var e=this,t=e.currentTime;r.each(e.adBreaks,function(e){e.startTime>t&&e.isLoaded()&&(e.abort(),e.refresh())})},f.setAutoChooseMidroll=function(e){var t=this;e&&p.bool(e.autoChoose)&&(s("自动中插点",e),t.midrollPoints=e,e.autoChoose?t.enableAutoChooseMidroll(e.nextMidroll):t.disableAutoChooseMidroll("初始化"))},f.enableAutoChooseMidroll=function(e){var t=this;return t.currentTime>e?void s("当前时间晚于自动中插点"):(s("启用自动中插点",e),void r.each(t.adBreaks,function(t){u.midroll==t.cuepointType&&(t.startTime==e?t.state=null:t.state="banned")}))},f.disableAutoChooseMidroll=function(e){var t=this;!1!==t.midrollPoints.autoChoose&&(s("停用自动中插点",e,t.midrollPoints),t.midrollPoints={autoChoose:!1},r.each(t.adBreaks,function(e){u.midroll==e.cuepointType&&(e.state=null)}))},f.ban=function(e){var t=this,n=r.filter(t.adBreaks,function(t){return r.isMatch(t,e)});r.each(n,function(e){e.state="banned"}),s("ban ad breaks",e,n)},f.prettyAdBreaks=function(){var e=this;e.sortAdBreaks()},f.sortAdBreaks=function(){var e=this,t=e.adBreaks;t&&t.sort(function(e,t){var n=e.cuepointType-t.cuepointType;return 0==n&&(n=e.startTime-t.startTime),n})}}).call(t,n(7))},function(e,t,n){(function(t,r){function i(e){e=e||{};var t=this;t.startTime=e.startTime,t.cuepointType=e.cuepointType,t.adZoneId=e.adZoneId,t.sequenceId=e.sequenceId,t.adZoneStyle=e.adZoneStyle,t.humanStartTime=o.humanizeDuration(t.startTime),t.state=null,t.request=null,t.ad=e.ad||null,t.priority=0,c.midroll==t.cuepointType?t.priority=10:c.viewPoint==t.cuepointType&&(t.priority=9)}var o=n(74),a=n(18)("schedule:adbreak"),s=n(113),c=n(58);e.exports=i;var u=10,d=i.prototype;d.isMid=function(){var e=[2,4,9,10,11];return!!(t.includes(e,this.cuepointType)&&this.startTime>0)},d.isOverlay=function(){var e=[8,10,11];return!!t.includes(e,this.cuepointType)},d.isValid=function(){if(r.number(this.startTime)&&r.number(this.cuepointType))return!0},d.isLoaded=function(){return!(!this.request&&!this.ad)},d.refresh=function(){this.request=null},d.fill=function(e){this.isLoaded()?a("is loaded, no need to request"):this.request=new s({adBreaks:[this]},e)},d.canLoad=function(e){return e>=this.startTime-u&&e<=this.startTime},d.abort=function(){this.request?this.request.abort():this.ad&&this.ad.abort()},d.getContext=function(){return this.ad||this.request}}).call(t,n(7),n(23))},function(e,t,n){(function(t){function r(e,t){var n=this;o.call(n),n.element=e,n.$video=$(e),n.$videoBox=n.$video.parent(),n.$adContainer=n.$videoBox,n.currentAd=null,n.sdk=t,i("raw video mode"),n.bindEvent(),n.options={},n.initAdElements()}var i=n(18)("raw-video"),o=n(43),a=n(94),s=n(95).template,c=n(74);e.exports=r,t.inherits(r,o);var u=r.prototype;u.bindEvent=function(){var e=this,t="playing pause waiting error ended play timeupdate seeked loadstart";e.$video.on(t,function(t){e.emit(t.type,t)})},u.initAdElements=function(){function e(){return r.emitToCurrentAd("skip"),!1}var r=this;c.addStyle(),r.$normalAdTip=$(s(n(174),a.resource)),r.$learnMore=$(s(n(175),a.resource)),r.$adContainer.append(r.$normalAdTip).append(r.$learnMore),t.each([r.$normalAdTip,r.$learnMore],function(e){e.css({"z-index":1e3}).addClass("h5-cupid")}),r.hideAllAdElements(),r.$learnMore.on("click",function(){r.emitToCurrentAd("clickAndOpen")});var i=$("body");i.on("click",".public-vip",e)},u.hideAllAdElements=function(e){i("hide all ad elements",e);var t=this;t.$normalAdTip.hide(),t.$learnMore.hide()},u.getControlsHeight=function(){return 0},u.emitToCurrentAd=function(e){var t=this,n=t.getCurrentAd();n&&n.emit(e)},u.getCurrentAd=function(){return this.currentAd},u.setCurrentAd=function(e){var n=this;n.lastAd=n.currentAd,n.currentAd=e;var r=t.get(n.lastAd,"id"),o=t.get(n.currentAd,"id");r!=o&&i("current ad changed",r," => ",o)},u.trySetOptions=function(e){var t=this;e=e||{},t._setOptions(e)},u._setOptions=function(e){var t=this;t.hideAllAdElements("默认清除"),t.options=e;var n=e.ad||t.getCurrentAd()||{};e.theme&&t.useTheme(e.theme,n)},u.removeOptions=function(e){var t=this;t.options={},t.hideAllAdElements(e)},u.useTheme=function(e,t){var n=this;if(e&&t){var r=n.sdk;t.clickThrough&&("h5-new"===r.adTheme?(n.$learnMore.addClass("ad-theme-"+r.adTheme),n.$learnMore.find(".ad-arrow-wrapper").text(""),n.$learnMore.find(".ad-arrow-wrapper").addClass("ad-arrow")):(n.$learnMore.removeClass("ad-theme-h5-new"),n.$learnMore.find(".ad-arrow-wrapper").removeClass("ad-arrow"),n.$learnMore.find(".ad-arrow-wrapper").html("&gt;")),n.$learnMore.show());var o=n.$normalAdTip.find(".vip-marketing-doc-wrapper");r.vipMarketingDocuments?(i("use vip marketing doc",r.vipMarketingDocuments),o.addClass("vip-marketing-doc").text(r.vipMarketingDocuments)):(o.text(""),o.removeClass("vip-marketing-doc")),("tw"===a.locale||/pad/i.test(n.sdk.deviceType))&&n.$normalAdTip.find(".public-vip").hide(),n.$normalAdTip.removeClass("ad-theme-h5-new").addClass("ad-theme-"+r.adTheme),n.$normalAdTip.show(),n.$countdown=n.$normalAdTip.find(".cd-time")}},u.updateCountdown=function(e){var t=this;t.$countdown&&t.$countdown.text(e)},u.abort=function(){},u.intCurrentTime=function(){return Math.round(this.currentTime())},t.each("currentTime src volume muted paused duration".split(" "),function(e){u[e]=function(t){var n=this.element;return void 0===t?n[e]:void(n[e]=t)}}),t.each("play pause addEventListener removeEventListener".split(" "),function(e){u[e]=function(){var t=this.element;t[e].apply(t,arguments)}})}).call(t,n(7))},function(e,t){e.exports='<div class="public-time">\n    <span class="cd-time">0</span>\n    <a class="public-vip" href="javascript:;">{会员免广告}<i class="vip-marketing-doc-wrapper"></i></a>\n</div>\n'},function(e,t){e.exports='<span class="cupid-learn-more">{了解详情}<i class="ad-arrow-wrapper"></i></span>'},function(e,t,n){var r=n(149),i=n(18)("external");t.externalAdMap={},t.render=function(e,n){i("external",e,n),n=n||{},n={clickThrough:n.clickThrough,creative:{creativeId:n.creativeId,creativeObject:n.creativeObject,templateType:n.templateType},isExternal:!0,externalAdMap:t.externalAdMap};var o={adZoneId:e,cuepointType:0},a=new r(n,o);a.play()}},function(e,t,n){(function(t){function r(e){var t=this;return t instanceof r?(t.queueList=e||[],void t.close()):new r(e)}var i=n(178),o=i.is;e.exports=r;var a=r.prototype;a.queue=function(){var e=this,t=arguments;e.isOpen?e.exec(t):e.queueList.push(t)},a.close=function(){this.isOpen=!1},a.open=function(){this.isOpen=!0,this.execAll()},a.execAll=function(){var e=this,t=e.queueList;i.each(t,function(t){e.exec(t)}),t.length=0},a.exec=function(e){var t,n=i.first(e),r=this.ctx;if(t=o.fn(n)?n:i.get(r,n),o.fn(t))try{t.apply(r,i.slice(e,1))}catch(a){}},a.overwriteQueue=function(e){var n=this;t[e]=function(){n.queue.apply(n,arguments)}}}).call(t,function(){return this}())},[190,179],[198,178,180,182,183,184,185,186,188,189],[191,181],10,[199,179],[195,179],[200,179],[192,179],[193,179,187],[194,179],[196,179],[197,179],function(e,t,n,r){e.exports=n(r)},function(e,t,n,r){function i(e){if(null!=e)return e.length}function o(e,t){var n=i(e);if(n&&v.fn(t))for(var r=0;r<n&&!1!==t(e[r],r,e);r++);return e}function a(e,t){var n=-1;return o(e,function(e,r,i){if(t(e,r,i))return n=r,!1}),n}function s(e){var t=[];return o(e,function(e){t.push(e)}),t}function c(e){if(e){var t=h.call(arguments,1);o(t,function(t){p(t,function(t,n){v.undef(t)||(e[n]=t)})})}return e}function u(e){return function(){return!e.apply(this,arguments)}}function d(e,t){return v.string(e)?e.indexOf(t):a(e,function(e){return t===e})}function l(e,t,n){return o(e,function(r,i){n=t(n,r,i,e)}),n}function p(e,t){if(e)for(var n in e)if(v.owns(e,n)&&!1===t(e[n],n,e))break;return e}function f(e){var t=[];return p(e,function(e,n){t.push(n)}),t}var v=n(r),h=[].slice,m=t;m.is=v,m.extend=m.assign=c,m.each=o,m.map=function(e,t){var n=[];return o(e,function(e,r,i){n[r]=t(e,r,i)}),n},m.filter=function(e,t){var n=[];return o(e,function(e,r,i){var o=t(e,r,i);o&&n.push(e)}),n},m.some=function(e,t){return-1!=a(e,t)},m.every=function(e,t){return-1==a(e,u(t))},m.reduce=l,m.findIndex=a,m.find=function(e,t){var n=m.findIndex(e,t);if(-1!=n)return e[n]},m.indexOf=d,m.includes=function(e,t){return-1!=d(e,t)},m.toArray=s,m.slice=function(e,t,n){var r=[],o=i(e);return o>=0&&(t=t||0,0!==n&&(n=n||o),v.fn(e.slice)||(e=s(e)),r=e.slice(t,n)),r},m.negate=u,m.forIn=p,m.keys=f;var g=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;m.trim=function(e){return null==e?"":(""+e).replace(g,"")},m.noop=function(){},m.len=i},function(e,t,n,r){function i(e){if(a.array(e))return e;var t=[];return o.tostr(e).replace(c,function(e,n,r,i){var o=n||e;r&&(o=i.replace(u,"$1")),t.push(o)}),t}var o=e.exports=n(r),a=o.is,s=(o.each,o.forIn);o.only=function(e,t){return e=e||{},a.string(t)&&(t=t.split(/ +/)),o.reduce(t,function(t,n){return null!=e[n]&&(t[n]=e[n]),t},{})},o.values=function(e){return o.map(o.keys(e),function(t){return e[t]})},o.pick=function(e,t){if(!a.fn(t))return o.pick(e,function(e,n){return n==t});var n={};return s(e,function(e,r,i){t(e,r,i)&&(n[r]=e)}),n},o.functions=function(e){return o.keys(o.pick(e,function(e){return a.fn(e)}))},o.mapKeys=function(e,t){var n={};return s(e,function(e,r,i){var o=t(e,r,i);n[o]=e}),n},o.mapObject=o.mapValues=function(e,t){var n={};return s(e,function(e,r,i){n[r]=t(e,r,i)}),n},o.get=function(e,t){if(t=i(t),t.length){var n=o.every(t,function(t){if(null!=e)return e=e[t],!0});if(n)return e}},o.has=function(e,t){if(t=i(t),t.length){var n=o.every(t,function(t){if(null!=e&&a.owns(e,t))return e=e[t],!0});if(n)return!0}return!1},o.set=function(e,t,n){t=i(t);var r=e;return o.every(t,function(e,i){if(a.oof(r)){if(i+1!=t.length){var o=r[e];if(null==o){var o={};~~e==e&&(o=[])}return r=r[e]=o,!0}r[e]=n}}),e},o.create=function(){function e(){}return function(t,n){return"object"!=typeof t&&(t=null),e.prototype=t,o.extend(new e,n)}}(),o.defaults=function(){var e=arguments,t=e[0],n=o.slice(e,1);return t&&o.each(n,function(e){o.mapObject(e,function(e,n){a.undef(t[n])&&(t[n]=e)})}),t},o.isMatch=function(e,t){var n=!0;return e=e||{},s(t,function(t,r){if(t!==e[r])return n=!1,!1}),n},o.toPlainObject=function(e){var t={};return s(e,function(e,n){t[n]=e}),t},o.invert=function(e){var t={};return s(e,function(e,n){t[e]=n}),t};var c=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,u=/\\(\\)?/g},function(e,t,n,r,i){function o(e){function t(){var t=arguments,r=t[0];if(!n.has(r)){var i=e.apply(this,t);n.set(r,i)}return n.get(r)}var n=new o.Cache;return t.cache=n,t}var a=e.exports=n(r),s=a.is,c=a.slice;a.bind=function(e,t){if(s.string(t)){var n=e;e=n[t],t=n}if(!s.fn(e))return e;var r=c(arguments,2);return t=t||this,function(){return e.apply(t,a.flatten([r,arguments]))}},a.inherits=function(e,t){e.super_=t,e.prototype=a.create(t.prototype,{constructor:e})},a.delay=function(e,t){var n=a.slice(arguments,2);return setTimeout(function(){e.apply(this,n)},t)},a.before=function(e,t){return function(){if(e>1)return e--,t.apply(this,arguments)}},a.once=function(e){return a.before(2,e)},a.after=function(e,t){return function(){return e>1?void e--:t.apply(this,arguments)}},a.throttle=function(e,t,n){return t=t||0,n=a.extend({leading:!0,trailing:!0,maxWait:t},n),a.debounce(e,t,n)},a.debounce=function(e,t,n){function r(){return!(p-d>t)&&!(u&&p-l>u)}function i(e,t,n){return d=a.now(),e.apply(t,n)}function o(){c&&(clearTimeout(c),c=null)}function s(){p=a.now();var s=r();l=p;var u=this,d=arguments;o(),s?n.trailing&&(c=a.delay(function(){i(e,u,d)},t)):i(e,u,d)}t=t||0,n=a.extend({leading:!1,trailing:!0},n);var c,u=n.maxWait,d=0,l=0,p=a.now();return n.leading||(d=p),s.cancel=o,s},o.Cache=n(i),a.memoize=o,a.wrap=function(e,t){return function(){var n=[e];return n.push.apply(n,arguments),t.apply(this,n)}},a.curry=function(e){function t(r){return function(){var i=r.concat(a.slice(arguments));return i.length>=n?(i.length=n,e.apply(this,i)):t(i)}}var n=e.length;return t([])}},function(e,t,n,r){function i(){this.data={}}var o=n(r),a=o.is;e.exports=i;var s=i.prototype;s.has=function(e){return a.owns(this.data,e)},s.get=function(e){return this.data[e]},s.set=function(e,t){this.data[e]=t},s["delete"]=function(e){delete this.data[e]}},function(e,t,n,r){var i=e.exports=n(r),o=i.is;i.now=function(){return+new Date},i.constant=function(e){return function(){return e}},i.identity=function(e){return e},i.random=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},i.mixin=function(e,t,n){var r=i.functions(t);if(e)if(o.fn(e)){n=n||{};var a=(!!n.chain,e.prototype);i.each(r,function(e){var n=t[e];a[e]=function(){var e=this,t=[e.__value];t.push.apply(t,arguments);var r=n.apply(e,t);return e.__chain?(e.__value=r,e):r}})}else i.each(r,function(n){e[n]=t[n]});return e},i.chain=function(e){var t=i(e);return t.__chain=!0,t},i.value=function(){return this.__chain=!1,this.__value}},function(e,t,n,r){function i(e,t){e=a.tostr(e)||" ";var n=Math.floor(t/e.length)+1;return a.repeat(e,n).slice(0,t)}function o(e){return e||0==e?e+"":""}var a=e.exports=n(r);a.tostr=o;var s=a.indexOf;a.split=function(e,t,n){return e=o(e),e.split(t,n)},a.capitalize=function(e){return e=o(e),e.charAt(0).toUpperCase()+e.substr(1)},a.decapitalize=function(e){return e=o(e),e.charAt(0).toLowerCase()+e.substr(1)},a.camelCase=function(e){e=o(e);var t=e.split(/[^\w]|_+/);return t=a.map(t,function(e){return a.capitalize(e)}),a.decapitalize(t.join(""))},a.startsWith=function(e,t){return 0==s(e,t)},a.endsWith=function(e,t){return t+="",t==a.slice(e,a.len(e)-a.len(t))},a.lower=function(e){return o(e).toLowerCase()},a.upper=function(e){return o(e).toUpperCase()},a.repeat=function(e,t){return a.map(a.range(t),function(){return e}).join("")},a.padStart=function(e,t,n){e=a.tostr(e),t=t||0;var r=t-e.length;return i(n,r)+e},a.padEnd=function(e,t,n){e=a.tostr(e),t=t||0;var r=t-e.length;return e+i(n,r)}},function(e,t,n,r){var i=e.exports=n(r);i.sum=function(e){return i.reduce(e,function(e,t){return e+t},0)},i.max=function(e,t){var n=-1,r=-(1/0);return t=t||i.identity,i.each(e,function(e,i){e=t(e),e>r&&(r=e,n=i)}),n>-1?e[n]:r},i.min=function(e,t){var n=-1,r=1/0;return t=t||i.identity,i.each(e,function(e,i){e=t(e),e<r&&(r=e,n=i)}),n>-1?e[n]:r}},function(e,t,n,r,i,o,a,s,c,u,d,l){(function(t){function t(e){return this instanceof t?(this.__value=e,void(this.__chain=!1)):new t(e)}var r=n(i);e.exports=r.extend(t,r),n(o),n(a),n(s),n(c),n(u),n(d),n(l),t.mixin(t,t)}).call(t,n(r))},function(e,t,n,r){var i=e.exports=n(r),o=i.is;i.isString=o.string,i.isArray=o.array,i.isArrayLike=o.arraylike,i.isBoolean=o.bool,i.isElement=o.element,i.isEmpty=o.empty,i.isFunction=o.fn,i.isInteger=o.integer,i.isNaN=o.nan,i.isNumber=o.number,i.isObject=o.object,i.isPlainObject=o.plainObject,i.isRegExp=o.regexp,i.isString=o.string,i.isUndefined=o.undef},function(e,t,n,r){function i(e,t){var n=[],r=o.len(t);if(r)for(t=t.sort(function(e,t){return e-t});r--;){var i=t[r];n.push(u.splice.call(e,i,1)[0])}return n.reverse(),n}var o=e.exports=n(r),a=o.each,s=o.includes,c=o.is,u=Array.prototype;o.reject=function(e,t){return o.filter(e,function(e,n,r){return!t(e,n,r)})},o.without=function(e){var t=o.slice(arguments,1);return o.difference(e,t)},o.difference=function(e,t){var n=[];return o.each(e,function(e){s(t,e)||n.push(e)}),n},o.pluck=function(e,t){return o.map(e,function(e){if(e)return e[t]})},o.first=function(e){if(e)return e[0]},o.last=function(e){var t=o.len(e);if(t)return e[t-1]},o.asyncMap=function(e,t,n){var r,i,o=[],s=0;a(e,function(a,c){i=!0,t(a,function(t,i){if(!r){if(s++,t)return r=!0,n(t);o[c]=i,s==e.length&&(r=!0,n(null,o))}})}),i||n(null)},o.uniq=function(e){return o.uniqBy(e)},o.uniqBy=function(e,t){var n=[],r=[];return c.fn(t)||(t=null),a(e,function(e){var i=e;t&&(i=t(e)),s(r,i)||(r.push(i),n.push(e))}),n},o.flatten=function(e){var t=[];return a(e,function(e){c.arraylike(e)?a(e,function(e){t.push(e)}):t.push(e)}),t},o.union=function(){return o.uniq(o.flatten(arguments))},o.sample=function(e,t){for(var n=o.toArray(e),r=n.length,i=Math.min(t||1,r),a=0;a<r;a++){var s=o.random(a,r-1),c=n[s];n[s]=n[a],n[a]=c}return n.length=i,null==t?n[0]:n},o.shuffle=function(e){return o.sample(e,1/0)},o.compact=function(e){return o.filter(e,o.identity)},o.rest=function(e){return o.slice(e,1)},o.invoke=function(){var e=arguments,t=e[0],n=e[1],r=c.fn(n);return e=o.slice(e,2),o.map(t,function(t){if(r)return n.apply(t,e);if(null!=t){var i=t[n];if(c.fn(i))return i.apply(t,e)}})},o.partition=function(e,t){var n=o.groupBy(e,function(e,n,r){var i=t(e,n,r);return i?1:2});return[n[1]||[],n[2]||[]]},o.groupBy=function(e,t){var n={};return o.each(e,function(e,r,i){var o=t(e,r,i);n[o]=n[o]||[],n[o].push(e)}),n},o.range=function(){var e=arguments;if(e.length<2)return o.range(e[1],e[0]);var t=e[0]||0,n=e[1]||0,r=e[2];c.number(r)||(r=1);var i=n-t;0!=r&&(i/=r);for(var a=[],s=t,u=0;u<i;u++)a.push(s),s+=r;return a},o.pullAt=function(e){var t=o.slice(arguments,1);return i(e,t)},o.remove=function(e,t){for(var n=o.len(e)||0,r=[];n--;)t(e[n],n,e)&&r.push(n);return i(e,r)},o.fill=function(e,t,n){},o.size=function(e){var t=0;if(e){var n=e.length;o.isInteger(n)&&n>=0?t=n:o.isObject(e)&&(t=o.keys(e).length)}return t}},function(e,t,n,r){function i(e,t,n){return n=o.find(arguments,function(e){return a.object(e)}),e=a.nos(e)?e:void 0,t=a.nos(t)?t:void 0,n=o.extend({},s,n,{sep:e,eq:t})}var o=n(r),a=o.is,s={sep:"&",eq:"=",encode:encodeURIComponent,decode:decodeURIComponent,keepRaw:!1,sort:null,ignoreValues:[void 0]};t.parse=function(e,t,n,r){e+="",r=i(t,n,r);var a=r.decode;return e=e.split(r.sep),o.reduce(e,function(e,t){if(t=t.split(r.eq),2==t.length){var n=t[0],i=t[1];if(!r.keepRaw)try{n=a(n),i=a(i)}catch(o){}e[n]=i}return e},{})},t.stringify=function(e,t,n,r){r=i(t,n,r);var s=o.keys(e),c=r.sort;c&&(a.fn(c)?s.sort(c):s.sort());var u=r.encode,d=[];return o.each(s,function(t){var n=e[t];o.includes(r.ignoreValues,n)||((a.nan(n)||null==n)&&(n=""),r.keepRaw||(t=u(t),n=u(n)),d.push(t+r.eq+n))}),d.join(r.sep)}},function(e,t,n,r){var i=n(r),o="InvalidCharacterError";t.decode=function(e){e=i.tostr(e);for(var t,n=[],r=0;r<e.length;r++)t=e.charCodeAt(r),t<128?n.push(t):t<2048?n.push(192|t>>6,128|63&t):t<55296||t>=57344?n.push(224|t>>12,128|t>>6&63,128|63&t):n.push(239,191,189);return n},t.encode=function(e){for(var t=[],n=0,r=0,i=0;i<e.length;i++){if(n=e[i],n>224)r=(15&n)<<12,n=e[++i],r|=(63&n)<<6,n=e[++i],r|=63&n;else if(n>192)r=(31&n)<<6,n=e[++i],r|=(63&n)<<6;else{if(n>128)throw new Error(o);r=n}t.push(String.fromCharCode(r))}return t.join("")}}]))});